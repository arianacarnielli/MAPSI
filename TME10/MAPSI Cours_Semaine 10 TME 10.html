<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<title>MAPSI Cours/Semaine 10 TME 10</title>
	<link href="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/base.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">g_DefaultStyle="fixed blue";</script>
	<script type="text/javascript" src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/app.js"></script>
<!--[if IE]>
<link href="http://mapsi.lip6.fr/pub/skins/skittlish/base_ie.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--HTMLHeader--><style type="text/css"><!--
.subpage h1, h1.subpage { margin:0px; margin-top:1.2em; margin-bottom:8px; 
    color: #006633;
	font-size: 150%; }
p.subpage { float: right; }
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#siteheader .sitetitle a{height:0px; background: url(http://example.com/mylogo.gif) left top no-repeat} #siteheader .sitetitle a, #siteheader .sitetag{padding-left: 0px} #siteheader .sitetag{margin-top: 44px}
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python .de1, .python .de2 {font-family: monospace; font-weight: normal;}
.python  {font-family:monospace;}
.python .imp {font-weight: bold; color: red;}
.python li, .python .li1 {font-family: monospace; color: black; font-weight: normal;}
.python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python .li2 {font-weight: bold;}
.python .kw1 {color: #ff7700;font-weight:bold;}
.python .kw2 {color: #008000;}
.python .kw3 {color: #dc143c;}
.python .kw4 {color: #0000cd;}
.python .co1 {color: #808080; font-style: italic;}
.python .coMULTI {color: #808080; font-style: italic;}
.python .es0 {color: #000099; font-weight: bold;}
.python .br0 {color: black;}
.python .sy0 {color: #66cc66;}
.python .st0 {color: #483d8b;}
.python .nu0 {color: #ff4500;}
.python .me1 {color: black;}
.python .ln-xtra, .python li.ln-xtra, .python div.ln-xtra {background-color: #ffc;}
.python span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  color: #000000;
  background-color: #fafafa;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript" src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/MathJax.js">MathJax.Hub.Config({
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: { inlineMath: [ ['{\$','\$}'] ], displayMath: [ ['{\$\$','\$\$}'] ] } });</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>  <meta name="robots" content="index,follow">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="fixed violet"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
	loadPreferences()
//]]>
</script>

	<div id="wrapper">
		<div id="header" class="clearfix">
			<div id="siteheader" class="clearfix">
				<!--PageHeaderFmt-->
				<h1 class="sitetitle"><a class="urllink" href="http://mapsi.lip6.fr/pmwiki.php" rel="nofollow">MAPSI</a></h1>
<div class="sitetag">Modèles et Algorithmes de Probabilités et Statistiques pour l'Informatique
</div>

				<!--/PageHeaderFmt-->
			</div>

			<!--PageTabsFmt-->
			<div id="menu">
				
			</div>
			<!--/PageTabsFmt-->
		</div>

		<div id="contentwrapper" class="clearfix">
			<div id="content">
				<div id="innerwrapper">
					<!--PageTitleGroupFmt-->
					<a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours" class="pagegroup">Cours</a>
					<!--/PageTitleGroupFmt-->
					<!--PageTitleFmt--><!--/PageTitleFmt-->

					<!--PageText-->
<div id="wikitext">
<div class="vspace"></div><h1>TME 10: Régression</h1>
<p>Nous travaillons aujourd'hui sur les méthodes de régression. Dans un 
premier temps, nous allons générer des données jouets pour valider 
l'implémentation des formules vues en cours. Nous verrons ensuite 
comment passer au non-linéaire (toujours sur des données jouets) puis 
nous étudierons ces méthodes sur des données réelles (qualité du vin).
</p>
<div class="vspace"></div><h2><span style="color: blue;"> Données jouets</span></h2>
<p>Dans un premier temps, générons des données jouets paramétriques:
</p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.734em, 1000em, 2.78em, -0.513em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">N</script> nombre de points à générer
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 5.121em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.049em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.509em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8712;</span><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="mn" id="MathJax-Span-9" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mn" id="MathJax-Span-12" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">x\in [0,\ 1]</script> tirage avec un simple <code>rand()</code>
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14" style="width: 15.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.388em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.765em, 1000em, 3.211em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8764;</span><span class="texatom" id="MathJax-Span-28" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.159em;"></span></span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-32" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-34" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.986em, 1000em, 2.791em, -0.513em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.78em; left: 0.594em;"><span class="mn" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.518em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">y = ax + b + \epsilon,\ \epsilon \sim \mathcal N(0,\sigma^2)</script>
</li><li>Pour faire cet énoncé, je suis parti des valeurs suivantes: 
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock1">
  <div class="sourceblocktext"><div class="python">a <span class="sy0">=</span> <span class="nu0">6</span>.<br>
<span class="me1">b</span> <span class="sy0">=</span> -<span class="nu0">1</span>.<br>
<span class="me1">N</span> <span class="sy0">=</span> <span class="nu0">100</span><br>
sig <span class="sy0">=</span> <span class="nu0">.4</span> <span class="co1"># écart type</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=1" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Notes:
</p><ul><li>Vous utiliserez la fonction <code>np.random.randn</code> pour le tirage de données selon une loi normale
</li><li>Vous obtenez un écart-type <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-38" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.986em, 1000em, 2.791em, -0.513em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">\sigma</script> par simple multiplication sur le tirage précédent 
<ul><li>il s'agit en fait d'une homothétie... Si 66% des points étaient entre -1 et 1, en multipliant par <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-41" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.986em, 1000em, 2.791em, -0.513em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\sigma</script>, 66% des points sont entre <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-44" style="width: 1.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.168em, 1000em, 2.972em, -0.46em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-45"><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">&#8722;</span><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">-\sigma</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-48" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.986em, 1000em, 2.791em, -0.513em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\sigma</script>
</li></ul></li></ul><div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/TME10_datagen.png" alt="" title="" width="300px"></div>
<div class="vspace"></div><h3><span style="color: purple;"> Validation des formules analytiques</span></h3>
<p>Nous avons vu deux types de résolutions analytique: à partir des 
estimateurs des espérances et co-variances d'une part et des moindres 
carrés d'autre part. Testons les deux méthodes.
</p>
<div class="vspace"></div><h4>Estimation de paramètres probabilistes</h4>
<ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-51" style="width: 9.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.675em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.783em, 1000em, 3.211em, -0.511em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="texatom" id="MathJax-Span-53"><span class="mrow" id="MathJax-Span-54"><span class="munderover" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px;"><span style="position: absolute; clip: rect(1.976em, 1000em, 2.79em, -0.511em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; clip: rect(1.905em, 1000em, 2.43em, -0.432em); top: -2.841em; left: 0.03em;"><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">c</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main;">/</span></span></span><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 1.041em; height: 0px;"><span style="position: absolute; clip: rect(1.986em, 1000em, 2.791em, -0.513em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; clip: rect(1.765em, 1000em, 2.599em, -0.509em); top: -2.762em; left: 0.594em;"><span class="mn" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span><span style="position: absolute; clip: rect(1.923em, 1000em, 2.606em, -0.519em); top: -2.269em; left: 0.543em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.495em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">\hat a = cov(X,Y) / \sigma_x^2</script>
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-74" style="width: 14.029em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.119em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.468em, 1000em, 3.571em, -0.474em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="texatom" id="MathJax-Span-76"><span class="mrow" id="MathJax-Span-77"><span class="munderover" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px;"><span style="position: absolute; clip: rect(1.723em, 1000em, 2.791em, -0.504em); top: -2.599em; left: 0.03em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; clip: rect(1.905em, 1000em, 2.43em, -0.432em); top: -3.094em; left: 0em;"><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mfrac" id="MathJax-Span-87" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.96em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.706em, 1000em, 2.775em, -0.52em); top: -3.017em; left: 50%; margin-left: -1.42em;"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span><span style="position: absolute; clip: rect(3.231em, 1000em, 4.28em, -0.522em); top: -3.489em; left: 50%; margin-left: -0.389em;"><span class="msubsup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(1.931em, 1000em, 2.606em, -0.522em); top: -2.417em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span><span style="position: absolute; clip: rect(1.782em, 1000em, 2.478em, -0.519em); top: -2.54em; left: 0.473em;"><span class="mn" id="MathJax-Span-99" style="font-size: 50%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.296em;"></span></span><span style="position: absolute; clip: rect(1.894em, 1000em, 2.483em, -0.526em); top: -2.192em; left: 0.422em;"><span class="mi" id="MathJax-Span-100" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.296em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 2.96em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.345em; vertical-align: -0.845em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">\hat b = E(Y) - \frac{cov(X, Y)}{\sigma^2_x} E(X)</script>
</li></ul><p class="vspace">Estimer les paramètres, faire passer les <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-105" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">x</script> dans le modèle et tracer la courbe associée.
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/TME10_linEstP.png" alt="" title="" width="300px"></div>
<div class="vspace"></div><h4>Formulation au sens des moindres carrés</h4>
<p>Nous partons directement sur une écriture matricielle. Du coup, il est nécessaire de construire la matrice <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-108" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.734em, 1000em, 2.78em, -0.518em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">X</script>... Il y a plein de piège (mais je donne la solution plus bas):
</p><ul><li>usage de <code>hstack</code> pour mettre cote à cote deux matrices: ATTENTION, la fonction prend en argument un tuple
</li><li>obligation de faire un reshape sur x (il ne sait pas comment agréger une matrice et un vecteur)
</li></ul><p class="vspace">Solution:
</p>
<div class="sourceblock " id="sourceblock2">
  <div class="sourceblocktext"><div class="python">X <span class="sy0">=</span> np.<span class="me1">hstack</span><span class="br0">(</span><span class="br0">(</span>x.<span class="me1">reshape</span><span class="br0">(</span>N<span class="sy0">,</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">,</span>np.<span class="me1">ones</span><span class="br0">(</span><span class="br0">(</span>N<span class="sy0">,</span><span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=2" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Il faut ensuite poser et résoudre un système d'équations linéaires de la forme <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-111" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.565em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.883em, 1000em, 2.972em, -0.509em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">B</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.068em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">A w = B</script>
</p>
<p class="vspace">Rappel des formules vues en cours/TD:
</p><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-117" style="width: 5.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.71em, 1000em, 2.961em, -0.509em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-121" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.734em, 1000em, 2.78em, -0.518em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.903em;"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.272em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">A = X^T X</script> (produit matriciel)
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-125" style="width: 5.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.351em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.71em, 1000em, 2.961em, -0.509em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-129" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.462em; height: 0px;"><span style="position: absolute; clip: rect(1.734em, 1000em, 2.78em, -0.518em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.827em; left: 0.903em;"><span class="mi" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.272em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">B = X^T Y</script> (produit matriciel)
</li></ul><p class="vspace">Fonction de résolution: <code>np.linalg.solve(A,B)</code>
</p>
<p class="vspace">Vous devez obtenir la même solution que précédemment.
Que se passe-t-il si on n'ajoute pas de biais dans <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-133" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.734em, 1000em, 2.78em, -0.518em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">X</script>? Tracer la solution obtenue.
</p>
<div class="vspace"></div><h3><span style="color: purple;"> Optimisation par descente de gradient</span></h3>
<p>Soit un problème avec des données <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-136" style="width: 7.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.384em, -0.45em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-139"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.544em;"><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-143" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.985em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.177em; left: 0.477em;"><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-146"><span style="display: inline-block; position: relative; width: 3.399em; height: 0px;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.489em); top: -2.78em; left: 0em;"><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.363em;"><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.63em; vertical-align: -0.609em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">(x_i,y_i)_{i=1,\ldots,N}</script>, une fonction de décision/prédiction paramétrée par un vecteur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-157" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.724em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">w</script> et une fonction de cout à optimiser <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-160" style="width: 2.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.494em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-161"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">C(w)</script>.
Notre but est de trouver les paramètres <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-166" style="width: 1.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.348em, 1000em, 2.428em, -0.523em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-167"><span class="msubsup" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.78em; left: 0.725em;"><span class="mo" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Main;">&#8902;</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.056em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">w^\star</script> minimisant la fonction de coût:
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" style=""><nobr><span class="math" id="MathJax-Span-171" style="width: 10.298em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.158em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.842em, 1000em, 3.669em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.83em; left: 0.725em;"><span class="mo" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">&#8902;</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.278em;">arg</span><span class="mo" id="MathJax-Span-178"></span><span class="munderover" id="MathJax-Span-179" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.692em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.961em, -0.519em); top: -2.78em; left: 0em;"><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span><span style="position: absolute; clip: rect(1.923em, 1000em, 2.706em, -0.529em); top: -1.817em; left: 0.604em;"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.997em; vertical-align: -0.968em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-20"> w^\star = \arg\min_w C(w)</script>
</p>
<p class="vspace">l'algorithme de la descente de gradient est le suivant (rappel):
</p>
<div class="vspace"></div><ol><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-186" style="width: 5.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.351em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.938em, 1000em, 3.127em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-187"><span class="msubsup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="mn" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8592;</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.194em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">w_0 \leftarrow init</script> par exemple : 0
</li><li>boucle
<ol><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-196" style="width: 12.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.152em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.948em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8592;</span><span class="msubsup" id="MathJax-Span-206" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="msubsup" id="MathJax-Span-213"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.994em, -0.498em); top: -2.78em; left: 0em;"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Main;">&#8711;</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.846em;"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="mi" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">w_{t+1} \leftarrow w_{t} - \epsilon \nabla_w C(w_t)</script>
</li></ol></li></ol><p class="vspace">Compléter le squelette d'implémentation fourni ci-dessous:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock3">
  <div class="sourceblocktext"><div class="python">wstar <span class="sy0">=</span> np.<span class="me1">linalg</span>.<span class="me1">solve</span><span class="br0">(</span>X.<span class="me1">T</span>.<span class="me1">dot</span><span class="br0">(</span>X<span class="br0">)</span><span class="sy0">,</span> X.<span class="me1">T</span>.<span class="me1">dot</span><span class="br0">(</span>y<span class="br0">)</span><span class="br0">)</span> <span class="co1"># pour se rappeler du w optimal</span><br>
<br>
eps <span class="sy0">=</span> <span class="nu0">5e-3</span><br>
nIterations <span class="sy0">=</span> <span class="nu0">30</span><br>
w <span class="sy0">=</span> np.<span class="me1">zeros</span><span class="br0">(</span>X.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> <span class="co1"># init à 0</span><br>
allw <span class="sy0">=</span> <span class="br0">[</span>w<span class="br0">]</span><br>
<span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">xrange</span><span class="br0">(</span>nIterations<span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="co1"># A COMPLETER =&gt; calcul du gradient vu en TD</span><br>
&nbsp; &nbsp; allw.<span class="me1">append</span><span class="br0">(</span>w<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">print</span> w<br>
<br>
allw <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span>allw<span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=3" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>Tester différentes valeurs d'epsilon
</li><li>Tester différentes initialisations
</li><li>comparer les résultats théoriques (solution analytique) et par descente de gradient
</li></ul><p class="vspace">On s'intéresse ensuite à comprendre la descente de gradient dans l'espace des paramètres. Le code ci-dessous permet de:
</p><ul><li>Tracer le cout pour un ensemble de paramètres
</li><li>Comprendre comment la solution évolue (en terme de coût) au fil des itérations du gradient
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock4">
  <div class="sourceblocktext"><div class="python"><span class="co1"># tracer de l'espace des couts</span><br>
ngrid <span class="sy0">=</span> <span class="nu0">20</span><br>
w1range <span class="sy0">=</span> np.<span class="me1">linspace</span><span class="br0">(</span>-<span class="nu0">0.5</span><span class="sy0">,</span> <span class="nu0">8</span><span class="sy0">,</span> ngrid<span class="br0">)</span><br>
w2range <span class="sy0">=</span> np.<span class="me1">linspace</span><span class="br0">(</span>-<span class="nu0">1.5</span><span class="sy0">,</span> <span class="nu0">1.5</span><span class="sy0">,</span> ngrid<span class="br0">)</span><br>
w1<span class="sy0">,</span>w2 <span class="sy0">=</span> np.<span class="me1">meshgrid</span><span class="br0">(</span>w1range<span class="sy0">,</span>w2range<span class="br0">)</span><br>
<br>
cost <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span><span class="br0">[</span>np.<span class="me1">log</span><span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>X.<span class="me1">dot</span><span class="br0">(</span>np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span>w1i<span class="sy0">,</span>w2j<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>-y<span class="br0">)</span>**<span class="nu0">2</span><span class="br0">)</span>.<span class="kw2">sum</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">for</span> w1i <span class="kw1">in</span> w1range<span class="br0">]</span> <span class="kw1">for</span> w2j <span class="kw1">in</span> w2range<span class="br0">]</span><span class="br0">)</span><br>
<br>
plt.<span class="me1">figure</span><span class="br0">(</span><span class="br0">)</span><br>
plt.<span class="me1">contour</span><span class="br0">(</span>w1<span class="sy0">,</span> w2<span class="sy0">,</span> cost<span class="br0">)</span><br>
plt.<span class="me1">scatter</span><span class="br0">(</span>wstar<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">,</span> wstar<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span>c<span class="sy0">=</span><span class="st0">'r'</span><span class="br0">)</span><br>
plt.<span class="me1">plot</span><span class="br0">(</span>allw<span class="br0">[</span>:<span class="sy0">,</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">,</span>allw<span class="br0">[</span>:<span class="sy0">,</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span><span class="st0">'b+-'</span> <span class="sy0">,</span>lw<span class="sy0">=</span><span class="nu0">2</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=4" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Vous devez obtenir une figure :
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/TME10_gradient.png" alt="" title="" width="300px"></div>
<p class="vspace">De manière optionnelle, on peut essayer de tracer la courbe de coût en 3D pour mieux visualiser ce qui se passe:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock5">
  <div class="sourceblocktext"><div class="python"><span class="kw1">from</span> mpl_toolkits.<span class="me1">mplot3d</span> <span class="kw1">import</span> Axes3D<br>
<br>
costPath <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span>np.<span class="me1">log</span><span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>X.<span class="me1">dot</span><span class="br0">(</span>wtmp<span class="br0">)</span>-y<span class="br0">)</span>**<span class="nu0">2</span><span class="br0">)</span>.<span class="kw2">sum</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">for</span> wtmp <span class="kw1">in</span> allw<span class="br0">]</span><span class="br0">)</span><br>
costOpt &nbsp;<span class="sy0">=</span> np.<span class="me1">log</span><span class="br0">(</span><span class="br0">(</span><span class="br0">(</span>X.<span class="me1">dot</span><span class="br0">(</span>wstar<span class="br0">)</span>-y<span class="br0">)</span>**<span class="nu0">2</span><span class="br0">)</span>.<span class="kw2">sum</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><br>
<br>
fig <span class="sy0">=</span> plt.<span class="me1">figure</span><span class="br0">(</span><span class="br0">)</span><br>
ax <span class="sy0">=</span> fig.<span class="me1">add_subplot</span><span class="br0">(</span><span class="nu0">111</span><span class="sy0">,</span> projection<span class="sy0">=</span><span class="st0">'3d'</span><span class="br0">)</span><br>
ax.<span class="me1">plot_surface</span><span class="br0">(</span>w1<span class="sy0">,</span> w2<span class="sy0">,</span> cost<span class="sy0">,</span> rstride <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">,</span> cstride<span class="sy0">=</span><span class="nu0">1</span> <span class="br0">)</span><br>
ax.<span class="me1">scatter</span><span class="br0">(</span>wstar<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">,</span> wstar<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span>costOpt<span class="sy0">,</span> c<span class="sy0">=</span><span class="st0">'r'</span><span class="br0">)</span><br>
ax.<span class="me1">plot</span><span class="br0">(</span>allw<span class="br0">[</span>:<span class="sy0">,</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">,</span>allw<span class="br0">[</span>:<span class="sy0">,</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span>costPath<span class="sy0">,</span> <span class="st0">'b+-'</span> <span class="sy0">,</span>lw<span class="sy0">=</span><span class="nu0">2</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=5" type="text/plain">[$[Get Code]]</a></div>
</div>

<h3><span style="color: purple;"> Extension non-linéaire (solution analytique)</span></h3>
<p>Générer de nouvelles données non-linéaires selon la formule: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-222" style="width: 21.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.679em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.765em, 1000em, 3.211em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.981em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.78em; left: 0.544em;"><span class="mn" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span><span class="mo" id="MathJax-Span-244" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8764;</span><span class="texatom" id="MathJax-Span-245" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.159em;"></span></span></span></span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-249" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.518em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">yquad = ax^2 + b x + c + \epsilon,\ \epsilon \sim \mathcal N(0,\sigma)</script> avec les mêmes valeurs de paramètres que précédemment.
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/TME10_datagenNL.png" alt="" title="" width="300px"></div>
<p class="vspace">Estimation de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-253" style="width: 2.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.296em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.905em, 1000em, 3.155em, -0.511em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-254"><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.271em; vertical-align: -0.321em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">a,b,c</script> au sens de l'erreur des moindres carrés:
</p><ul><li>construire un nouveau <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-260" style="width: 8.09em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.406em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.765em, 1000em, 3.211em, -0.518em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-261"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.278em;">[</span><span class="msubsup" id="MathJax-Span-266"><span style="display: inline-block; position: relative; width: 0.981em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.78em; left: 0.544em;"><span class="mn" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.518em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">Xe= [x^2,\ x, 1]</script> en utilisant la méthode <code>hstack</code> vue dans la question précédente
</li><li>estimer un vecteur w sur ces données en utilisant la solution analytique (les données sont petites, pas la peine de s'embéter)
</li><li>reconstruire <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-275" style="width: 3.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.723em, 1000em, 2.985em, -0.523em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.285em; vertical-align: -0.334em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">yquad</script>
</li><li>calculer l'erreur moyenne de reconstruction
</li></ul><p class="vspace">Vous devez obtenir un estimateur de la forme:
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%2010%20TME%2010_fichiers/TME10_quad.png" alt="" title="" width="300px"></div>
<div class="vspace"></div><h2><span style="color: blue;"> Données réelles</span></h2>
<p>Récupérer les données sur la qualité vin.
</p>
<div class="vspace"></div><ul><li>Source originale: <a class="urllink" href="https://archive.ics.uci.edu/ml/datasets/Wine+Quality" rel="nofollow">https://archive.ics.uci.edu/ml/datasets/Wine+Quality</a>
</li></ul><div class="vspace"></div><h3>Chargement des données</h3>
<p>Le jeu de données sera séparé en un jeu d'apprentissage (pour 
l'estimation des paramètres) et un jeu de test (pour l'estimation non 
biaisée de la performance)
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock6">
  <div class="sourceblocktext"><div class="python">data <span class="sy0">=</span> np.<span class="me1">loadtxt</span><span class="br0">(</span><span class="st0">"ressources/winequality-red.csv"</span><span class="sy0">,</span> delimiter<span class="sy0">=</span><span class="st0">";"</span><span class="sy0">,</span> skiprows<span class="sy0">=</span><span class="nu0">1</span><span class="br0">)</span><br>
N<span class="sy0">,</span>d <span class="sy0">=</span> data.<span class="me1">shape</span> <span class="co1"># extraction des dimensions</span><br>
pcTrain &nbsp;<span class="sy0">=</span> <span class="nu0">0.7</span> <span class="co1"># 70% des données en apprentissage</span><br>
allindex <span class="sy0">=</span> np.<span class="kw3">random</span>.<span class="me1">permutation</span><span class="br0">(</span>N<span class="br0">)</span><br>
indTrain <span class="sy0">=</span> allindex<span class="br0">[</span>:<span class="kw2">int</span><span class="br0">(</span>pcTrain*N<span class="br0">)</span><span class="br0">]</span><br>
indTest <span class="sy0">=</span> allindex<span class="br0">[</span><span class="kw2">int</span><span class="br0">(</span>pcTrain*N<span class="br0">)</span>:<span class="br0">]</span><br>
X <span class="sy0">=</span> data<span class="br0">[</span>indTrain<span class="sy0">,</span>:-<span class="nu0">1</span><span class="br0">]</span> <span class="co1"># pas la dernière colonne (= note à prédire)</span><br>
Y <span class="sy0">=</span> data<span class="br0">[</span>indTrain<span class="sy0">,</span>-<span class="nu0">1</span><span class="br0">]</span> &nbsp;<span class="co1"># dernière colonne (= note à prédire)</span><br>
<span class="co1"># Echantillon de test (pour la validation des résultats)</span><br>
XT <span class="sy0">=</span> data<span class="br0">[</span>indTest<span class="sy0">,</span>:-<span class="nu0">1</span><span class="br0">]</span> <span class="co1"># pas la dernière colonne (= note à prédire)</span><br>
YT <span class="sy0">=</span> data<span class="br0">[</span>indTest<span class="sy0">,</span>-<span class="nu0">1</span><span class="br0">]</span> &nbsp;<span class="co1"># dernière colonne (= note à prédire)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=sourceblock&amp;num=6" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Tester différents modèles de régression sur ce jeu de données.
</p><ul><li>Utiliser le modèle analytique (qui va beaucoup plus vite sur les petits jeux de données)
</li><li>Toujours comparer les performances en apprentissage et en test
</li><li>Construire plusieurs métriques d'évaluation
<ul><li>Erreur moyenne de prédiction
</li><li>En arrondissant les sorties de notre modèle, on peut compter le nombre de fois où l'on trouve la note exacte
</li></ul></li><li>Construire de nouveau attribut (ie de nouvelles 
colonnes descriptives) en combinant les données existantes (à la manière
 de ce que nous avons fait précédemment)
</li></ul><div class="vspace"></div><h2><span style="color: blue;"> Pour aller plus loin</span></h2>
<h3><span style="color: purple;"> Optimisation par descente de gradient <strong>stochastique</strong></span></h3>
<p>Soit un problème avec des données <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-282" style="width: 7.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.384em, -0.45em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.544em;"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-289" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.985em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.177em; left: 0.477em;"><span class="mi" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 3.399em; height: 0px;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.489em); top: -2.78em; left: 0em;"><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span><span style="position: absolute; top: -2.132em; left: 0.363em;"><span class="texatom" id="MathJax-Span-294"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-297" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-298" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.63em; vertical-align: -0.609em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">(x_i,y_i)_{i=1,\ldots,N}</script>, une fonction de décision/prédiction paramétrée par un vecteur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-303" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-304"><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.724em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">w</script> et une fonction de cout à optimiser <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-306" style="width: 2.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.494em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">C(w)</script>.
</p>
<p class="vspace">l'algorithme de la descente de gradient <strong>stochastique</strong> est le suivant :
</p>
<div class="vspace"></div><ol><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-312" style="width: 5.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.351em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.938em, 1000em, 3.127em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-313"><span class="msubsup" id="MathJax-Span-314"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="mn" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8592;</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">i</span><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.194em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">w_0 \leftarrow init</script> par exemple : 0
</li><li>boucle
<ol><li>tirage d'une donnée <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-322" style="width: 0.476em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.363em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.756em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.999em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">i</script>: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-325" style="width: 3.674em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.901em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.45em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-326"><span class="mo" id="MathJax-Span-327" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.791em, -0.509em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.544em;"><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-332" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(1.975em, 1000em, 2.985em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.177em; left: 0.477em;"><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">(x_i,y_i)</script>
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-336" style="width: 12.811em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.152em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.849em, 1000em, 3.211em, -0.523em); top: -2.78em; left: 0em;"><span class="mrow" id="MathJax-Span-337"><span class="msubsup" id="MathJax-Span-338"><span style="display: inline-block; position: relative; width: 1.948em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="texatom" id="MathJax-Span-340"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-343" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-344" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8592;</span><span class="msubsup" id="MathJax-Span-346" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.974em, 1000em, 2.791em, -0.523em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.725em;"><span class="texatom" id="MathJax-Span-348"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="msubsup" id="MathJax-Span-353"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.916em, 1000em, 2.994em, -0.498em); top: -2.78em; left: 0em;"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Main;">&#8711;</span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.846em;"><span class="mi" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-356"><span style="display: inline-block; position: relative; width: 1.057em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.802em, -0.494em); top: -2.599em; left: 0em;"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span style="display: inline-block; width: 0px; height: 2.599em;"></span></span><span style="position: absolute; top: -2.267em; left: 0.741em;"><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.417em;"></span></span></span></span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.78em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">w_{t+1} \leftarrow w_{t} - \epsilon \nabla_w C_i(w)</script>
</li></ol></li></ol><p class="vspace">Reprendre rapidement les questions ci-dessus.
</p>
</div>

				</div>
			</div>

			<div id="sidebar">
				<!--PageSearchFmt-->
				<div class="boxy short">
					<div id="search">
						<h3>Search</h3>

						<form id="searchform" action="http://mapsi.lip6.fr/pmwiki.php" method="get">
						<fieldset>
							<input type="hidden" name="n" value="Cours.Semaine10TME10">
							<input type="hidden" name="action" value="search">
							<input class="searchBox" type="text" id="q" name="q">
							<input class="searchButton" type="submit" value="Go">
						</fieldset>
						</form>
					</div>
				</div>
				<!--/PageSearchFmt-->

				<!--PageRightFmt-->
				<div class="boxy tall">
					<p class="sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.TutoPythonJN">Tutoriel numpy</a>
</p>
<div class="vspace"></div>

				</div>
				<!--/PageRightFmt-->
			</div>
		</div>

		<div id="options-container">
			<!--PageOptionsFmt-->
			<div id="options">
				<h2>Options:</h2>
				<ul id="option_size">
					<li title="size: fixed" id="option_size_fixed" class="fixed"><a><span>fixed</span></a></li>
					<li title="size: fluid" id="option_size_fluid" class="fluid"><a><span>fluid</span></a></li>
				</ul>

				<ul id="option_color">
					<li title="color: orange" id="option_color_orange" class="orange"><a><span>orange</span></a></li>
					<li title="color: blue" id="option_color_blue" class="blue"><a><span>blue</span></a></li>
					<li title="color: green" id="option_color_green" class="green"><a><span>green</span></a></li>
					<li title="color: pink" id="option_color_pink" class="pink"><a><span>pink</span></a></li>
					<li title="color: cyan" id="option_color_cyan" class="cyan"><a><span>cyan</span></a></li>
					<li title="color: red" id="option_color_red" class="red"><a><span>red</span></a></li>
					<li title="color: violet" id="option_color_violet" class="violet"><a><span>violet</span></a></li>
				</ul>
			</div>
			<!--/PageOptionsFmt-->

			<!--PageActionFmt-->
			<div class="pageactions">
				<ul><li class="browse">      <a accesskey="" rel="nofollow" class="selflink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10">View</a>
</li><li class="edit">      <a accesskey="e" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=edit">Edit</a>
</li><li class="diff">   <a accesskey="h" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=diff">History</a>
</li><li class="print">     <a accesskey="" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10TME10?action=print">Print</a>
</li></ul>

			</div>
			<!--/PageActionFmt-->
		</div>

		<div id="footer">
			<!--PageFooterFmt-->
				<div class="footer"><p>Page last modified on December 19, 2017, at 11:08 AM EST
</p>
</div>
			<!--/PageFooterFmt-->
			<p id="credits"><a href="http://evil.che.lu/projects/skittlish">Skittlish</a> theme adapted by <a href="http://solidgone.org/Skins/">David Gilbert</a>, powered by <a href="http://pmwiki.com/">PmWiki</a></p>
		</div>
	</div>
<!--HTMLFooter-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Caligraphic, sans-serif;"></div></div></body></html>