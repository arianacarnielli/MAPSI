<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<title>MAPSI Cours/Semaine 8 TME 8</title>
	<link href="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/base.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">g_DefaultStyle="fixed blue";</script>
	<script type="text/javascript" src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/app.js"></script>
<!--[if IE]>
<link href="http://mapsi.lip6.fr/pub/skins/skittlish/base_ie.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--HTMLHeader--><style type="text/css"><!--
.subpage h1, h1.subpage { margin:0px; margin-top:1.2em; margin-bottom:8px; 
    color: #006633;
	font-size: 150%; }
p.subpage { float: right; }
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#siteheader .sitetitle a{height:0px; background: url(http://example.com/mylogo.gif) left top no-repeat} #siteheader .sitetitle a, #siteheader .sitetag{padding-left: 0px} #siteheader .sitetag{margin-top: 44px}
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python .de1, .python .de2 {font-family: monospace; font-weight: normal;}
.python  {font-family:monospace;}
.python .imp {font-weight: bold; color: red;}
.python li, .python .li1 {font-family: monospace; color: black; font-weight: normal;}
.python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python .li2 {font-weight: bold;}
.python .kw1 {color: #ff7700;font-weight:bold;}
.python .kw2 {color: #008000;}
.python .kw3 {color: #dc143c;}
.python .kw4 {color: #0000cd;}
.python .co1 {color: #808080; font-style: italic;}
.python .coMULTI {color: #808080; font-style: italic;}
.python .es0 {color: #000099; font-weight: bold;}
.python .br0 {color: black;}
.python .sy0 {color: #66cc66;}
.python .st0 {color: #483d8b;}
.python .nu0 {color: #ff4500;}
.python .me1 {color: black;}
.python .ln-xtra, .python li.ln-xtra, .python div.ln-xtra {background-color: #ffc;}
.python span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  color: #000000;
  background-color: #fafafa;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript" src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/MathJax.js">MathJax.Hub.Config({
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: { inlineMath: [ ['{\$','\$}'] ], displayMath: [ ['{\$\$','\$\$}'] ] } });</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>  <meta name="robots" content="index,follow">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="fixed violet"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
	loadPreferences()
//]]>
</script>

	<div id="wrapper">
		<div id="header" class="clearfix">
			<div id="siteheader" class="clearfix">
				<!--PageHeaderFmt-->
				<h1 class="sitetitle"><a class="urllink" href="http://mapsi.lip6.fr/pmwiki.php" rel="nofollow">MAPSI</a></h1>
<div class="sitetag">Modèles et Algorithmes de Probabilités et Statistiques pour l'Informatique
</div>

				<!--/PageHeaderFmt-->
			</div>

			<!--PageTabsFmt-->
			<div id="menu">
				
			</div>
			<!--/PageTabsFmt-->
		</div>

		<div id="contentwrapper" class="clearfix">
			<div id="content">
				<div id="innerwrapper">
					<!--PageTitleGroupFmt-->
					<a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours" class="pagegroup">Cours</a>
					<!--/PageTitleGroupFmt-->
					<!--PageTitleFmt--><!--/PageTitleFmt-->

					<!--PageText-->
<div id="wikitext">
<div class="vspace"></div><h1>TME 8: Méthodes discriminantes</h1>
<p class="vspace">Nous allons travailler dans cette séance sur un 
comparatif des modèles génératifs et discriminants pour la 
classification de chiffres manuscrits. 
Les résultats de référence sont ceux obtenus avec un modèle génératif 
issu de la séance 3 (cf <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3">sujet semaine 3</a>).
</p>
<div class="vspace"></div><h2><span style="color: blue;"> Résultats de référence avec la méthode génératrice</span></h2>
<p>Afin que tout le monde reparte de la même base, nous redonnons les données (au format pickle) et un code pour la résolution:
</p>
<p class="vspace">Données USPS (zipées): <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/usps.pkl.zip" rel="nofollow">usps.pkl.zip</a>
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock1">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> numpy <span class="kw1">as</span> np<br>
<span class="kw1">import</span> <span class="kw3">pickle</span> <span class="kw1">as</span> pkl<br>
<br>
<span class="co1"># fonction de suppression des 0 (certaines variances sont nulles car les pixels valent tous la même chose)</span><br>
<span class="kw1">def</span> woZeros<span class="br0">(</span>x<span class="br0">)</span>: <br>
&nbsp; &nbsp; y <span class="sy0">=</span> np.<span class="me1">where</span><span class="br0">(</span>x<span class="sy0">==</span><span class="nu0">0</span>.<span class="sy0">,</span> <span class="nu0">1</span>.<span class="sy0">,</span> x<span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> y<br>
<br>
<span class="co1"># Apprentissage d'un modèle naïf où chaque pixel est modélisé par une gaussienne (+hyp. d'indépendance des pixels)</span><br>
<span class="co1"># cette fonction donne 10 modèles (correspondant aux 10 classes de chiffres)</span><br>
<span class="co1"># USAGE: theta = learnGauss ( X,Y )</span><br>
<span class="co1"># theta[0] : modèle du premier chiffre, 
&nbsp;theta[0][0] : vecteur des moyennes des pixels, theta[0][1] : 
vecteur des variances des pixels</span><br>
<span class="kw1">def</span> learnGauss <span class="br0">(</span>X<span class="sy0">,</span>Y<span class="br0">)</span>: <br>
&nbsp; &nbsp; theta <span class="sy0">=</span> <span class="br0">[</span><span class="br0">(</span>X<span class="br0">[</span>Y<span class="sy0">==</span>y<span class="br0">]</span>.<span class="me1">mean</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><span class="sy0">,</span>woZeros<span class="br0">(</span>X<span class="br0">[</span>Y<span class="sy0">==</span>y<span class="br0">]</span>.<span class="me1">var</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">for</span> y <span class="kw1">in</span> np.<span class="me1">unique</span><span class="br0">(</span>Y<span class="br0">)</span><span class="br0">]</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> <span class="br0">(</span>np.<span class="kw3">array</span><span class="br0">(</span>theta<span class="br0">)</span><span class="br0">)</span> <br>
<br>
<span class="co1"># Application de TOUS les modèles sur TOUTES les images: résultat = matrice (nbClasses x nbImages)</span><br>
<span class="kw1">def</span> logpobs<span class="br0">(</span>X<span class="sy0">,</span> theta<span class="br0">)</span>:<br>
&nbsp; &nbsp; logp <span class="sy0">=</span> <span class="br0">[</span><span class="br0">[</span>-<span class="nu0">0.5</span>*np.<span class="me1">log</span><span class="br0">(</span>mod<span class="br0">[</span><span class="nu0">1</span><span class="sy0">,</span>:<span class="br0">]</span> * <span class="br0">(</span><span class="nu0">2</span> * np.<span class="me1">pi</span> <span class="br0">)</span><span class="br0">)</span>.<span class="kw2">sum</span><span class="br0">(</span><span class="br0">)</span> + -<span class="nu0">0.5</span> * <span class="br0">(</span> <span class="br0">(</span> x - mod<span class="br0">[</span><span class="nu0">0</span><span class="sy0">,</span>:<span class="br0">]</span> <span class="br0">)</span>**<span class="nu0">2</span> / mod<span class="br0">[</span><span class="nu0">1</span><span class="sy0">,</span>:<span class="br0">]</span> <span class="br0">)</span>.<span class="kw2">sum</span> <span class="br0">(</span><span class="br0">)</span> <span class="kw1">for</span> x <span class="kw1">in</span> X<span class="br0">]</span> <span class="kw1">for</span> mod <span class="kw1">in</span> theta <span class="br0">]</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> np.<span class="kw3">array</span><span class="br0">(</span>logp<span class="br0">)</span><br>
<br>
<span class="co1">######################################################################</span><br>
<span class="co1">######################### &nbsp; &nbsp; script &nbsp; &nbsp; &nbsp;############################</span><br>
<br>
<br>
<span class="co1"># Données au format pickle: le fichier contient X, XT, Y et YT</span><br>
<span class="co1"># X et Y sont les données d'apprentissage; les matrices en T sont les données de test</span><br>
data <span class="sy0">=</span> pkl.<span class="me1">load</span><span class="br0">(</span><span class="kw2">file</span><span class="br0">(</span><span class="st0">'ressources/usps_small.pkl'</span><span class="sy0">,</span><span class="st0">'rb'</span><span class="br0">)</span><span class="br0">)</span><br>
<br>
X <span class="sy0">=</span> data<span class="br0">[</span><span class="st0">'X'</span><span class="br0">]</span><br>
Y <span class="sy0">=</span> data<span class="br0">[</span><span class="st0">'Y'</span><span class="br0">]</span><br>
XT <span class="sy0">=</span> data<span class="br0">[</span><span class="st0">'XT'</span><span class="br0">]</span><br>
YT <span class="sy0">=</span> data<span class="br0">[</span><span class="st0">'YT'</span><span class="br0">]</span><br>
<br>
theta <span class="sy0">=</span> learnGauss <span class="br0">(</span> X<span class="sy0">,</span>Y <span class="br0">)</span> <span class="co1"># apprentissage</span><br>
<br>
logp &nbsp;<span class="sy0">=</span> logpobs<span class="br0">(</span>X<span class="sy0">,</span> theta<span class="br0">)</span> &nbsp;<span class="co1"># application des modèles sur les données d'apprentissage</span><br>
logpT <span class="sy0">=</span> logpobs<span class="br0">(</span>XT<span class="sy0">,</span> theta<span class="br0">)</span> <span class="co1"># application des modèles sur les données de test</span><br>
<br>
ypred &nbsp;<span class="sy0">=</span> logp.<span class="me1">argmax</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> &nbsp; &nbsp;<span class="co1"># indice de la plus grande proba (colonne par colonne) = prédiction</span><br>
ypredT <span class="sy0">=</span> logpT.<span class="me1">argmax</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><br>
<br>
<span class="kw1">print</span> <span class="st0">"Taux bonne classification en apprentissage : "</span><span class="sy0">,</span>np.<span class="me1">where</span><span class="br0">(</span>ypred <span class="sy0">!=</span> Y<span class="sy0">,</span> <span class="nu0">0</span>.<span class="sy0">,</span><span class="nu0">1</span>.<span class="br0">)</span>.<span class="me1">mean</span><span class="br0">(</span><span class="br0">)</span><br>
<span class="kw1">print</span> <span class="st0">"Taux bonne classification en test : "</span><span class="sy0">,</span>np.<span class="me1">where</span><span class="br0">(</span>ypredT <span class="sy0">!=</span> YT<span class="sy0">,</span> <span class="nu0">0</span>.<span class="sy0">,</span><span class="nu0">1</span>.<span class="br0">)</span>.<span class="me1">mean</span><span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=1" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><span style="color: red;"> Validation (du copier-coller!)</span>
</p><pre>  Taux bonne classification en apprentissage :  0.826498422713
  Taux bonne classification en test :  0.782760338814
</pre><div class="vspace"></div><h2><span style="color: blue;"> Approche discriminante</span></h2>
<p>Nous allons coder l'algorithme de la régression logistique, vu en TD. Cet algorithme itératif de classification <strong>binaire</strong>  présente les caractéristiques suivantes:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 24.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.096em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.316em, 1000em, 4.013em, -0.489em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="msubsup" id="MathJax-Span-7"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-9" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-11" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">p</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-27" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 9.124em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.993em, 1000em, 3.022em, -0.461em); top: -3.517em; left: 50%; margin-left: -0.242em;"><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.969em, 1000em, 3.332em, -0.461em); top: -2.16em; left: 50%; margin-left: -4.502em;"><span class="mrow" id="MathJax-Span-29"><span class="mn" id="MathJax-Span-30" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Main; padding-left: 0.222em;">exp</span><span class="mo" id="MathJax-Span-33"></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">&#8722;</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-37"><span class="mrow" id="MathJax-Span-38"><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 9.124em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.093em; vertical-align: -1.325em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">  f (\mathbf{x_i}) = p(y=1 | \mathbf{x_i} ) = \frac{1}{1 + \exp( -(  \mathbf{x_i} \mathbf{w} + b))} </script>
</p>
<p class="vspace">Formule de la log-vraisemblance:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" style=""><nobr><span class="math" id="MathJax-Span-49" style="width: 32.989em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.166em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.709em, 1000em, 4.213em, -0.512em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-55"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-59" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.829em, 1000em, 2.767em, -0.529em); top: -1.394em; left: 0.604em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-62" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="msubsup" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-81" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-86" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-94"></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-96" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-106"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.851em; vertical-align: -1.578em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-2"> \mathcal L_{\log}= \sum_i  y_i log (p(y=1 | \mathbf{x_i} )) + (1-y_i) ( \log(1- p(y=1 | \mathbf{x_i} ))) </script>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" style=""><nobr><span class="math" id="MathJax-Span-114" style="width: 26.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.03em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.709em, 1000em, 4.213em, -0.512em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="msubsup" id="MathJax-Span-116"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-124" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.829em, 1000em, 2.767em, -0.529em); top: -1.394em; left: 0.604em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-127" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mn" id="MathJax-Span-145" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-153"></span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-155" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="msubsup" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.851em; vertical-align: -1.578em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-3"> \mathcal L_{\log}= \sum_i  y_i log ( f (\mathbf{x_i}) ) + (1-y_i) (\log(1-  f (\mathbf{x_i}))) </script>
</p>
<p class="vspace">Problème d'apprentissage:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" style=""><nobr><span class="math" id="MathJax-Span-167" style="width: 12.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.85em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.894em, 1000em, 3.927em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.891em; left: 0.725em;"><span class="mo" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Main;">&#8902;</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-174" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.899em; left: 0.423em;"><span class="mo" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Main;">&#8902;</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.278em;">arg</span><span class="mo" id="MathJax-Span-180"></span><span class="munderover" id="MathJax-Span-181" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.873em; height: 0px;"><span style="position: absolute; clip: rect(2.211em, 1000em, 3.033em, -0.519em); top: -2.84em; left: 0em;"><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.806em, 1000em, 2.896em, -0.529em); top: -1.809em; left: 0.423em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-188" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.257em; vertical-align: -1.217em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4"> (w^\star, b^\star) = \arg\max_{w,b} \mathcal L_{\log} </script>
</p>
<p class="vspace">Malheureusement, pas de solution analytique (cf TD)...
 Nous utiliserons donc une résolution itérative basée sur la dérivation 
de la vraisemblance (montée de gradient, détaillée ci-dessous).
</p>
<p class="vspace">Formule de dérivation de la vraisemblance: 
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-5-Frame" style=""><nobr><span class="math" id="MathJax-Span-195" style="width: 16.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.053em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.926em, 1000em, 4.217em, -0.544em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mfrac" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 1.812em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -3.517em; left: 50%; margin-left: -0.272em;"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.944em, 1000em, 3.316em, -0.502em); top: -2.134em; left: 50%; margin-left: -0.846em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 1.812em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-204" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-212" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.767em, -0.529em); top: -1.39em; left: 0.151em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.713em, 1000em, 2.659em, -0.522em); top: -3.628em; left: 0.423em;"><span class="mi" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-220" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.509em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.544em;"><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.842em; vertical-align: -1.582em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-5"> \frac{\partial  }{\partial w_j} \mathcal L_{\log} =\sum_{i=1}^N x_{ij}( y_i- f (\mathbf{x_i}))</script>
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" style=""><nobr><span class="math" id="MathJax-Span-240" style="width: 13.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.998em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.926em, 1000em, 4.217em, -0.544em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-241"><span class="mfrac" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -3.517em; left: 50%; margin-left: -0.272em;"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -2.134em; left: 50%; margin-left: -0.483em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 1.087em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-247" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-255" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.767em, -0.529em); top: -1.39em; left: 0.151em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-260" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.713em, 1000em, 2.659em, -0.522em); top: -3.628em; left: 0.423em;"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-264"><span style="display: inline-block; position: relative; width: 0.794em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-266" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-270"><span class="mrow" id="MathJax-Span-271"><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-276" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.842em; vertical-align: -1.582em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-6"> \frac{\partial  }{\partial b} \mathcal  L_{\log} = \sum_{i=1}^N (y_i -  f (\mathbf{x_i}))</script>
</p>
<div class="vspace"></div><h3><span style="color: purple;"> Apprentissage d'un modèle binaire</span></h3>
<p>L'apprentissage de la régression logistique est non-trivial:
</p><ul><li>les formules de gradient ne sont pas annulables analytiquement
</li><li>nous allons chercher à augmenter progressivement la vraisemblance du modèle (cf figure ci-dessous)
<ul><li>Initialisation aléatoire des paramètres <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-277" style="width: 7.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.497em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.852em, -0.497em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">&#955;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mn" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-288" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">\lambda_0 = \{w_0, b_0\}</script>
</li><li>Tant que la convergence n'est pas atteinte:
<ul><li>Mise à jour:
</li></ul></li></ul></li></ul><p><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" style=""><nobr><span class="math" id="MathJax-Span-292" style="width: 13.725em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.877em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.267em, 1000em, 4.022em, -0.544em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Main;">&#8704;</span><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-296" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-297" style="font-family: MathJax_Main; padding-left: 0.167em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-298"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-302" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="mfrac" id="MathJax-Span-307" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.812em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -3.517em; left: 50%; margin-left: -0.272em;"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.944em, 1000em, 3.316em, -0.502em); top: -2.134em; left: 50%; margin-left: -0.846em;"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 1.102em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 1.812em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-314" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.166em; vertical-align: -1.337em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-8"> \forall j,\ w_j = w_j + \epsilon \frac{\partial  }{\partial w_j} \mathcal L_{\log}</script>
<span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" style=""><nobr><span class="math" id="MathJax-Span-321" style="width: 9.004em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.131em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.267em, 1000em, 3.75em, -0.504em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mo" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">&#1013;</span><span class="mfrac" id="MathJax-Span-328" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.087em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -3.517em; left: 50%; margin-left: -0.272em;"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(1.944em, 1000em, 3.044em, -0.502em); top: -2.134em; left: 50%; margin-left: -0.483em;"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Main;">&#8706;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 1.087em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-333" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.646em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 2.862em, -0.512em); top: -2.659em; left: 0em;"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.665em;"><span class="texatom" id="MathJax-Span-337"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-size: 70.7%; font-family: MathJax_Main;">log</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 2.823em; vertical-align: -0.994em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-9"> b = b + \epsilon \frac{\partial  }{\partial b} \mathcal L_{\log}</script>
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/monteeGradient.png" alt="" title="" width="300px"></div>
<p class="vspace"><strong>Précisions diverses</strong>:
</p>
<div class="vspace"></div><ul><li>il faut donner <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-340" style="width: 0.552em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\epsilon</script> à l'algorithme: tester des valeurs entre <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-343" style="width: 2.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.191em, 1000em, 2.439em, -0.461em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 2.009em; height: 0px;"><span style="position: absolute; clip: rect(1.993em, 1000em, 3.044em, -0.461em); top: -2.84em; left: 0em;"><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.871em; left: 1.027em;"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="mo" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.268em; vertical-align: -0.104em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">10^{-3}</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-351" style="width: 2.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.191em, 1000em, 2.439em, -0.461em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-352"><span class="msubsup" id="MathJax-Span-353"><span style="display: inline-block; position: relative; width: 2.009em; height: 0px;"><span style="position: absolute; clip: rect(1.993em, 1000em, 3.044em, -0.461em); top: -2.84em; left: 0em;"><span class="mn" id="MathJax-Span-354" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.871em; left: 1.027em;"><span class="texatom" id="MathJax-Span-355"><span class="mrow" id="MathJax-Span-356"><span class="mo" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-358" style="font-size: 70.7%; font-family: MathJax_Main;">5</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.269em; vertical-align: -0.104em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">10^{-5}</script>
</li><li>pour l'initialisation de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-359" style="width: 7.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.497em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-360"><span class="msubsup" id="MathJax-Span-361"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.852em, -0.497em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">&#955;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mn" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-364" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="msubsup" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 1.163em; height: 0px;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.725em;"><span class="mn" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-370" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\lambda_0 = \{w_0, b_0\}</script>, il faut choisir des valeurs petites (de l'ordre de  <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-374" style="width: 0.552em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\epsilon</script> par exemple)
</li><li>il faut que les valeurs de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-377" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.361em, 1000em, 2.583em, -0.497em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="msubsup" id="MathJax-Span-379"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.852em, -0.497em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Math; font-style: italic;">&#955;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mn" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.235em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">\lambda_0 </script> soient positives et négatives (elles n'ont pas de raison d'être uniquement positives)
</li><li>pour faciliter le codage initial, coder en dur le nombre 
d'itérations à réaliser (100 par exemple) au lieu de vérifier la 
convergence
</li><li>pour vérifier que votre algorithme fonctionne bien:
<ul><li>calculer la vraisemblance à chaque itération et la stocker
</li><li>tracer l'évolution de la vraisemblance à la fin des itérations
</li></ul></li></ul><p class="vspace">Résultats envisageables en jouant sur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-382" style="width: 0.552em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.504em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\epsilon</script> et le nombre d'itération (un seul est satisfaisant!):
</p>
<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/rl_vrais1.png" alt="" title="" width="200px"><br><span style="font-size:83%">Divergence (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-385" style="width: 0.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.972em, 1000em, 2.851em, -0.615em); top: -2.621em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.621em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.74em; vertical-align: -0.106em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\epsilon</script> trop grand)</span> </div>
<div> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/rl_vrais2.png" alt="" title="" width="200px"><br><span style="font-size:83%">Convergence incomplète: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-388" style="width: 0.573em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.437em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.972em, 1000em, 2.851em, -0.615em); top: -2.621em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span></span><span style="display: inline-block; width: 0px; height: 2.621em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.74em; vertical-align: -0.106em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\epsilon</script> petit ou nbIter faible</span> </div>
<div> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/rl_vrais3.png" alt="" title="" width="200px"><br><span style="font-size:83%">bonne convergence</span></div>
<p class="vspace"><span style="color: red;"> <strong>Indication pour refaire les courbes</strong></span>
</p>
<p class="vspace">Les valeurs qui marchent bien sont: <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-391" style="width: 5.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.411em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.993em, 1000em, 3.044em, -0.504em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">&#1013;</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-395" style="font-family: MathJax_Main; padding-left: 0.278em;">5</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-398" style="font-family: MathJax_Main; padding-left: 0.222em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.019em; vertical-align: -0.104em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\epsilon=5e-5</script> et nombre d'itérations = 120.
Pour afficher ce qui se passe en cas de divergence, il faut éviter les valeurs trop faibles qui font des <code>nan</code> qui ne sont pas affichables... J'ai un peu triché dans le calcul de vraisemblance en introduisant le calcul robuste suivant:
</p>
<div class="sourceblock " id="sourceblock2">
  <div class="sourceblocktext"><div class="python"><span class="br0">(</span>Y * np.<span class="me1">log</span><span class="br0">(</span>np.<span class="me1">maximum</span><span class="br0">(</span>f<span class="sy0">,</span><span class="nu0">1e-8</span><span class="br0">)</span><span class="br0">)</span> + <span class="br0">(</span><span class="nu0">1</span>-Y<span class="br0">)</span>*np.<span class="me1">log</span><span class="br0">(</span><span class="nu0">1</span>-np.<span class="me1">minimum</span><span class="br0">(</span>f<span class="sy0">,</span><span class="nu0">1</span>-<span class="nu0">1e-8</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span>.<span class="kw2">sum</span><span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=2" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><h3><span style="color: purple;"> Paradigme un-contre-tous pour le passage au multi-classe</span></h3>
<p>Nous avons mis en place un classifieur binaire alors que le problème qui nous intéresse compte 10 classes. L'idée est:
</p><ul><li>d'apprendre 10 classifieurs : 1 classe contre tout le reste des données
</li></ul>
<div class="sourceblock " id="sourceblock3">
  <div class="sourceblocktext"><div class="python"><span class="co1"># Pour transformer le vecteur Y afin de traiter la classe 0:</span><br>
Yc0 <span class="sy0">=</span> np.<span class="me1">where</span><span class="br0">(</span>Y<span class="sy0">==</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">1</span>.<span class="sy0">,</span><span class="nu0">0</span>.<span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=3" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>chaque classifieur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-399" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.35em, 1000em, 2.665em, -0.489em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="msubsup" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 3.045em, -0.489em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.484em;"><span class="mi" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.353em; vertical-align: -0.389em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">f_c</script> donne un score (la probabilité d'appartenir à la classe cible <code>c</code>)
</li></ul><p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" style=""><nobr><span class="math" id="MathJax-Span-404" style="width: 10.984em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.702em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.489em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 3.045em, -0.489em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.484em;"><span class="mi" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-409" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-410"><span class="mrow" id="MathJax-Span-411"><span class="msubsup" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">p</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-422"><span class="mrow" id="MathJax-Span-423"><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-425"><span class="mrow" id="MathJax-Span-426"><span class="msubsup" id="MathJax-Span-427"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">f_c(\mathbf{x_i})  = p(y=1 | \mathbf{x_i}) </script>
</p>
<div class="vspace"></div><ul><li>en stockant tous les scores dans une matrice, nous nous retrouvons dans le même cas de figure qu'avec les modèles génératifs
</li></ul>
<div class="sourceblock " id="sourceblock4">
  <div class="sourceblocktext"><div class="python"><span class="co1"># si vos paramètres w et b, correspondant à chaque classe, sont stockés sur les lignes de thetaRL... Alors:</span><br>
<br>
pRL &nbsp;<span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span><span class="br0">[</span><span class="nu0">1</span>./<span class="br0">(</span><span class="nu0">1</span>+np.<span class="me1">exp</span><span class="br0">(</span>-x.<span class="me1">dot</span><span class="br0">(</span>mod<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span> - mod<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">for</span> x <span class="kw1">in</span> X<span class="br0">]</span> <span class="kw1">for</span> mod <span class="kw1">in</span> thetaRL <span class="br0">]</span><span class="br0">)</span><br>
pRLT <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span><span class="br0">[</span><span class="nu0">1</span>./<span class="br0">(</span><span class="nu0">1</span>+np.<span class="me1">exp</span><span class="br0">(</span>-x.<span class="me1">dot</span><span class="br0">(</span>mod<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span> - mod<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="kw1">for</span> x <span class="kw1">in</span> XT<span class="br0">]</span> <span class="kw1">for</span> mod <span class="kw1">in</span> thetaRL <span class="br0">]</span><span class="br0">)</span><br>
ypred &nbsp;<span class="sy0">=</span> pRL.<span class="me1">argmax</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><br>
ypredT <span class="sy0">=</span> pRLT.<span class="me1">argmax</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><br>
<span class="kw1">print</span> <span class="st0">"Taux bonne classification en apprentissage : "</span><span class="sy0">,</span>np.<span class="me1">where</span><span class="br0">(</span>ypred <span class="sy0">!=</span> Y<span class="sy0">,</span> <span class="nu0">0</span>.<span class="sy0">,</span><span class="nu0">1</span>.<span class="br0">)</span>.<span class="me1">mean</span><span class="br0">(</span><span class="br0">)</span><br>
<span class="kw1">print</span> <span class="st0">"Taux bonne classification en test : "</span><span class="sy0">,</span>np.<span class="me1">where</span><span class="br0">(</span>ypredT <span class="sy0">!=</span> YT<span class="sy0">,</span> <span class="nu0">0</span>.<span class="sy0">,</span><span class="nu0">1</span>.<span class="br0">)</span>.<span class="me1">mean</span><span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=4" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Calculer la performance en apprentissage et en test de
 la regression logistique sur les données USPS et comparer avec les 
modèles génératifs.
</p>
<p class="vspace">Tracer des matrices de confusion à la manière de ce qui a été fait dans les dernières séances.
</p>
<p class="vspace">Note: le code est quasi-identique.
</p>
<div class="vspace"></div><h3><span style="color: purple;"> Analyse qualitative comparée des modèles (génératifs/discriminants)</span></h3>
<h4>Pour le modèle génératif codé en début de séance:</h4>
<p>Ce modèle est bien un modèle génératif: en tirant des pixels aléatoirement selon la loi d'un chiffre <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-431" style="width: 10.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.219em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.844em, 1000em, 3.501em, -0.571em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-432"><span class="texatom" id="MathJax-Span-433"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.159em;"></span></span></span></span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-437"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.056em, -0.521em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.226em; left: 0.604em;"><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-442" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-444" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-445" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-448" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-449" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.975em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.594em;"><span class="mn" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.798em, 1000em, 2.804em, -0.52em); top: -2.144em; left: 0.543em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.783em; vertical-align: -0.68em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\mathcal N(\mu_{chiffre}, \sigma^2_{chiffre})</script>, il est possible de générer une infinité de chiffres, tous différents les uns des autres mais tous issus du même modèle!
</p>
<p class="vspace">Comparer plusieurs chiffres générer à partir du même modèle et afficher le vecteur moyen du modèle.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock5">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> matplotlib.<span class="me1">pyplot</span> <span class="kw1">as</span> plt<br>
<span class="kw1">import</span> matplotlib.<span class="me1">cm</span> <span class="kw1">as</span> cm<br>
<br>
<span class="co1"># pour afficher le vecteur des moyennes des pixels pour le modèle 0:</span><br>
plt.<span class="me1">figure</span><span class="br0">(</span><span class="br0">)</span><br>
plt.<span class="me1">imshow</span><span class="br0">(</span>theta<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="me1">reshape</span><span class="br0">(</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">16</span><span class="br0">)</span><span class="sy0">,</span> cmap <span class="sy0">=</span> cm.<span class="me1">Greys_r</span><span class="sy0">,</span> interpolation<span class="sy0">=</span><span class="st0">'nearest'</span><span class="br0">)</span><br>
plt.<span class="me1">show</span><span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=5" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><div> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/modelChiffre.png" alt="" title="" width="300px"> <img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/chiffreGenere.png" alt="" title="" width="300px"></div>
<p class="vspace"><strong>Note:</strong> pour tirer un nombre <code>x</code> selon une loi gaussienne de paramètre <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-462" style="width: 10.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.219em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.844em, 1000em, 3.501em, -0.571em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-463"><span class="texatom" id="MathJax-Span-464"><span class="mrow" id="MathJax-Span-465"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.159em;"></span></span></span></span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 3.036em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.056em, -0.521em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.226em; left: 0.604em;"><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-475" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-480" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.975em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.594em;"><span class="mn" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.798em, 1000em, 2.804em, -0.52em); top: -2.144em; left: 0.543em;"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.783em; vertical-align: -0.68em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\mathcal N(\mu_{chiffre}, \sigma^2_{chiffre})</script>:
</p>
<div class="sourceblock " id="sourceblock6">
  <div class="sourceblocktext"><div class="python">x<span class="sy0">=</span>np.<span class="kw3">random</span>.<span class="me1">randn</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> * np.<span class="me1">sqrt</span><span class="br0">(</span>sigma2<span class="br0">)</span> + mu</div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=sourceblock&amp;num=6" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><strong>Note 2:</strong> dans un premier temps, nous avions détecté les variances nulles pour les mettre à 1 afin de pouvoir calculer les <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-493" style="width: 5.273em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.17em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.518em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-496"></span><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">p</span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-500"><span class="mrow" id="MathJax-Span-501"><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">&#955;</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\log p(x|\lambda)</script> sans tomber toujours sur <code>nan</code>... Mais cette aménagement doit être supprimé lors de la génération de chiffre.
</p>
<p class="vspace"><strong>Note 3:</strong> les pixels générés peuvent 
être positifs... Ou négatifs. Alors que dans la base de données, tous 
les pixels sont positifs... Du coup, pour obtenir un résultat plus 
vraisemblable, il est intéressant de ne garder que les valeurs positives
 (et de mettre à 0 les valeurs négatives).
</p>
<div class="vspace"></div><h4>Pour le modèle discriminant:</h4>
<p>Visualiser le vecteur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-505" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.035em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-506"><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.724em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">w</script> de la régression logistique pour chaque classe: cela vous indique les pixels qui ''comptent' dans la prise de décision.
En étudiant <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-508" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.35em, 1000em, 2.658em, -0.489em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-509"><span class="msubsup" id="MathJax-Span-510"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(1.773em, 1000em, 3.045em, -0.489em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.484em;"><span class="mn" id="MathJax-Span-512" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.343em; vertical-align: -0.379em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">f_2</script>,
 par défaut, vous visualisez ce qui distingue un 2 de tous les autres 
chiffres. Il est possible de pousser plus loin l'analyse qualitative en 
apprenant une régression logistique spécifique aux 2 et 3 par exemple 
pour comprendre comment le modèle distingue ces deux classes.
</p>
<div class="vspace"></div><div><img src="MAPSI%20Cours_Semaine%208%20TME%208_fichiers/rlModel2.png" alt="" title="" width="300px"></div>
<p class="vspace">Zones blanches = si un pixel est présent, le modèle augmente la probabilité de reconnaitre un 2.
</p>
<div class="vspace"></div><h3><span style="color: purple;"> Optimisation du modèle discriminant</span></h3>
<p>Mettre en place un critère d'arrêt basé sur l'évolution de la 
vraisemblance dans la procédure évolutive. L'idée est la même que dans 
les séances passée (cf <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine7TME7">TME de la semaine 7</a>).
</p>
<p class="vspace">Mettre en place une stratégie de rejet des 
échantillons ambigus: étudier l'amélioration des résultats en fonction 
du nombre d'échantillon rejetés.
Etudier en particulier les cas suivants:
</p><ul><li>Parmi tous les <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-513" style="width: 6.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.197em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.583em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-521" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="msubsup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-529" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">p(y_c=1 | \mathbf{x_i})</script>, aucun ne dépasse 0.5 (ie, pour le modèle, le chiffre présenté ne ressemble à rien)
</li><li>Parmi tous les <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-531" style="width: 6.567em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.197em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.583em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.045em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.237em; left: 0.477em;"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span><span class="texatom" id="MathJax-Span-540"><span class="mrow" id="MathJax-Span-541"><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-543"><span class="mrow" id="MathJax-Span-544"><span class="msubsup" id="MathJax-Span-545"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.523em); top: -2.84em; left: 0em;"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.604em;"><span class="mi" id="MathJax-Span-547" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">i</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">p(y_c=1 | \mathbf{x_i})</script>, le max et le second plus grand sont très proches (seuil à définir)
</li></ul><p class="vspace">En général, on présente les résultats sous 
la forme d'une courbe de pourcentage de reconnaissance (en ordonnées) 
qui évolue en fonction du nombre d'échantillon rejetés.
</p>
</div>

				</div>
			</div>

			<div id="sidebar">
				<!--PageSearchFmt-->
				<div class="boxy short">
					<div id="search">
						<h3>Search</h3>

						<form id="searchform" action="http://mapsi.lip6.fr/pmwiki.php" method="get">
						<fieldset>
							<input type="hidden" name="n" value="Cours.Semaine8TME8">
							<input type="hidden" name="action" value="search">
							<input class="searchBox" type="text" id="q" name="q">
							<input class="searchButton" type="submit" value="Go">
						</fieldset>
						</form>
					</div>
				</div>
				<!--/PageSearchFmt-->

				<!--PageRightFmt-->
				<div class="boxy tall">
					<p class="sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.TutoPythonJN">Tutoriel numpy</a>
</p>
<div class="vspace"></div>

				</div>
				<!--/PageRightFmt-->
			</div>
		</div>

		<div id="options-container">
			<!--PageOptionsFmt-->
			<div id="options">
				<h2>Options:</h2>
				<ul id="option_size">
					<li title="size: fixed" id="option_size_fixed" class="fixed"><a><span>fixed</span></a></li>
					<li title="size: fluid" id="option_size_fluid" class="fluid"><a><span>fluid</span></a></li>
				</ul>

				<ul id="option_color">
					<li title="color: orange" id="option_color_orange" class="orange"><a><span>orange</span></a></li>
					<li title="color: blue" id="option_color_blue" class="blue"><a><span>blue</span></a></li>
					<li title="color: green" id="option_color_green" class="green"><a><span>green</span></a></li>
					<li title="color: pink" id="option_color_pink" class="pink"><a><span>pink</span></a></li>
					<li title="color: cyan" id="option_color_cyan" class="cyan"><a><span>cyan</span></a></li>
					<li title="color: red" id="option_color_red" class="red"><a><span>red</span></a></li>
					<li title="color: violet" id="option_color_violet" class="violet"><a><span>violet</span></a></li>
				</ul>
			</div>
			<!--/PageOptionsFmt-->

			<!--PageActionFmt-->
			<div class="pageactions">
				<ul><li class="browse">      <a accesskey="" rel="nofollow" class="selflink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8">View</a>
</li><li class="edit">      <a accesskey="e" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=edit">Edit</a>
</li><li class="diff">   <a accesskey="h" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=diff">History</a>
</li><li class="print">     <a accesskey="" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8TME8?action=print">Print</a>
</li></ul>

			</div>
			<!--/PageActionFmt-->
		</div>

		<div id="footer">
			<!--PageFooterFmt-->
				<div class="footer"><p>Page last modified on October 19, 2015, at 07:14 PM EST
</p>
</div>
			<!--/PageFooterFmt-->
			<p id="credits"><a href="http://evil.che.lu/projects/skittlish">Skittlish</a> theme adapted by <a href="http://solidgone.org/Skins/">David Gilbert</a>, powered by <a href="http://pmwiki.com/">PmWiki</a></p>
		</div>
	</div>
<!--HTMLFooter-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size2, sans-serif;"></div></div></body></html>