<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<title>MAPSI Cours/TME 9</title>
	<link href="MAPSI%20Cours_TME%209_fichiers/base.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">g_DefaultStyle="fixed blue";</script>
	<script type="text/javascript" src="MAPSI%20Cours_TME%209_fichiers/app.js"></script>
<!--[if IE]>
<link href="http://mapsi.lip6.fr/pub/skins/skittlish/base_ie.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--HTMLHeader--><style type="text/css"><!--
.subpage h1, h1.subpage { margin:0px; margin-top:1.2em; margin-bottom:8px; 
    color: #006633;
	font-size: 150%; }
p.subpage { float: right; }
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#siteheader .sitetitle a{height:0px; background: url(http://example.com/mylogo.gif) left top no-repeat} #siteheader .sitetitle a, #siteheader .sitetag{padding-left: 0px} #siteheader .sitetag{margin-top: 44px}
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python .de1, .python .de2 {font-family: monospace; font-weight: normal;}
.python  {font-family:monospace;}
.python .imp {font-weight: bold; color: red;}
.python li, .python .li1 {font-family: monospace; color: black; font-weight: normal;}
.python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python .li2 {font-weight: bold;}
.python .kw1 {color: #ff7700;font-weight:bold;}
.python .kw2 {color: #008000;}
.python .kw3 {color: #dc143c;}
.python .kw4 {color: #0000cd;}
.python .co1 {color: #808080; font-style: italic;}
.python .coMULTI {color: #808080; font-style: italic;}
.python .es0 {color: #000099; font-weight: bold;}
.python .br0 {color: black;}
.python .sy0 {color: #66cc66;}
.python .st0 {color: #483d8b;}
.python .nu0 {color: #ff4500;}
.python .me1 {color: black;}
.python .ln-xtra, .python li.ln-xtra, .python div.ln-xtra {background-color: #ffc;}
.python span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  color: #000000;
  background-color: #fafafa;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript" src="MAPSI%20Cours_TME%209_fichiers/MathJax.js">MathJax.Hub.Config({
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: { inlineMath: [ ['{\$','\$}'] ], displayMath: [ ['{\$\$','\$\$}'] ] } });</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>  <meta name="robots" content="index,follow">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="fixed violet"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
	loadPreferences()
//]]>
</script>

	<div id="wrapper">
		<div id="header" class="clearfix">
			<div id="siteheader" class="clearfix">
				<!--PageHeaderFmt-->
				<h1 class="sitetitle"><a class="urllink" href="http://mapsi.lip6.fr/pmwiki.php" rel="nofollow">MAPSI</a></h1>
<div class="sitetag">Modèles et Algorithmes de Probabilités et Statistiques pour l'Informatique
</div>

				<!--/PageHeaderFmt-->
			</div>

			<!--PageTabsFmt-->
			<div id="menu">
				
			</div>
			<!--/PageTabsFmt-->
		</div>

		<div id="contentwrapper" class="clearfix">
			<div id="content">
				<div id="innerwrapper">
					<!--PageTitleGroupFmt-->
					<a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours" class="pagegroup">Cours</a>
					<!--/PageTitleGroupFmt-->
					<!--PageTitleFmt--><!--/PageTitleFmt-->

					<!--PageText-->
<div id="wikitext">
<div class="vspace"></div><h1>TME 9: Monte-Carlo par chaînes de Markov (MCMC)</h1>
<h2 style="background-color: #e6d8c0;">Partie obligatoire</h2>
<p>Nous allons tester expérimentalement ce qui a été vu en TD.
</p>
<div class="vspace"></div><h2><span style="color: blue;"> Estimation de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.56em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.102em, 1000em, 2.721em, -0.246em); top: -2.622em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">&#960;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.616em; vertical-align: -0.05em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\pi</script> par Monte Carlo</span></h2>
<p>Ecrivez une fonction <strong>tirage</strong> <code>: float -&gt; float x float</code> prenant en un nombre paramètre réel <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.523em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">m</script> et retournant un point tiré aléatoirement selon la loi uniforme dans le carré <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7" style="width: 10.451em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.279em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.426em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">&#8722;</span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">m</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.222em;">[</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">&#8722;</span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">m</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3"> [-m, m] \times [-m,m] </script>.
</p>
<p class="vspace">En utilisant la fonction précédente, écrivez une fonction <strong>monteCarlo</strong> <code>: int -&gt; float x float np.array x float np.array</code> prenant en paramètre <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-22" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">N</script>, le nombre de tirages, et retournant un triplet composé d'une estimation de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-25" style="width: 0.78em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.604em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.851em, -0.525em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-style: italic;">&#960;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.709em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">\pi</script> par Monte Carlo ainsi que du tableau numpy des <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-28" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">N</script> abscisses et du tableau des <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-31" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">N</script> ordonnées tirées qui ont permis d'obtenir cette estimation.
</p>
<p class="vspace">Tracez le carré <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-34" style="width: 8.547em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.768em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.426em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main; padding-left: 0.222em;">[</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-45" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8"> [-1, 1] \times [-1,1] </script>, le cercle de centre l'origine <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-49" style="width: 2.836em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.236em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-52" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">(0,0)</script>
 et de rayon 1, et les points tirés avec une couleur différente selon 
qu'ils sont dans le cercle ou non. Vous pouvez utiliser le code suivant 
afin de faire l'affichage.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock1">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> matplotlib.<span class="me1">pyplot</span> <span class="kw1">as</span> plt<br>
<br>
plt.<span class="me1">figure</span><span class="br0">(</span><span class="br0">)</span><br>
<br>
<span class="co1"># trace le carré</span><br>
plt.<span class="me1">plot</span><span class="br0">(</span><span class="br0">[</span>-<span class="nu0">1</span><span class="sy0">,</span> -<span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> <span class="br0">[</span>-<span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> -<span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> <span class="st0">'-'</span><span class="br0">)</span><br>
<br>
<span class="co1"># trace le cercle</span><br>
x <span class="sy0">=</span> np.<span class="me1">linspace</span><span class="br0">(</span>-<span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">100</span><span class="br0">)</span><br>
y <span class="sy0">=</span> np.<span class="me1">sqrt</span><span class="br0">(</span><span class="nu0">1</span>- x*x<span class="br0">)</span><br>
plt.<span class="me1">plot</span><span class="br0">(</span>x<span class="sy0">,</span> y<span class="sy0">,</span> <span class="st0">'b'</span><span class="br0">)</span><br>
plt.<span class="me1">plot</span><span class="br0">(</span>x<span class="sy0">,</span> -y<span class="sy0">,</span> <span class="st0">'b'</span><span class="br0">)</span><br>
<br>
<span class="co1"># estimation par Monte Carlo</span><br>
pi<span class="sy0">,</span> x<span class="sy0">,</span> y <span class="sy0">=</span> monteCarlo<span class="br0">(</span><span class="kw2">int</span><span class="br0">(</span><span class="nu0">1e4</span><span class="br0">)</span><span class="br0">)</span><br>
<br>
<span class="co1"># trace les points dans le cercle et hors du cercle</span><br>
dist <span class="sy0">=</span> x*x + y*y <br>
plt.<span class="me1">plot</span><span class="br0">(</span>x<span class="br0">[</span>dist <span class="sy0">&lt;=</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> y<span class="br0">[</span>dist <span class="sy0">&lt;=</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> <span class="st0">"go"</span><span class="br0">)</span><br>
plt.<span class="me1">plot</span><span class="br0">(</span>x<span class="br0">[</span>dist<span class="sy0">&gt;</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> y<span class="br0">[</span>dist<span class="sy0">&gt;</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> <span class="st0">"ro"</span><span class="br0">)</span><br>
plt.<span class="me1">show</span><span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=1" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Vous devriez obtenir une figure similaire à celle ci-dessous:
</p>
<div class="vspace"></div><div style="text-align: center;">   <img src="MAPSI%20Cours_TME%209_fichiers/2015_tme9_montCarlo.png" alt="" title="" width="500px"></div>
<div class="vspace"></div><h2><span style="color: blue;"> Décodage par la méthode de Metropolis-Hastings</span></h2>
<p>Nous travaillons sur des textes en anglais pour éviter les problèmes avec les accents.
</p>
<p class="vspace">1) Téléchargez le fichier <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/countWar.pkl" rel="nofollow">countWar.pkl</a> qui contient le modèle de bigrammes appris à partir du roman <em>War and Peace</em>
 de Tolstoï.
Ce texte a été choisi car il contient plus de 3 millions de caractères, 
ce qui est assez long pour apprendre un modèle représentatif d'une 
langue.
Téléchargez également le message <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/secret.txt" rel="nofollow">secret.txt</a> à décoder (ou celui-ci <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/secret2.txt" rel="nofollow">secret2.txt</a>, même message codé différemment si vous avez des problèmes avec le premier fichier).
</p>
<p class="vspace">2) Exécutez le code suivant pour charger en python le modèle de bigrammes et le message secret. 
</p>
<div class="vspace"></div><ul><li>La variable <code>count</code> est un dictionnaire : pour chaque lettre du roman <em>War and Peace</em>, il fournit son nombre d'occurrences dans le roman.
</li><li>Le modèle de bigrammes est décrit par les variables <code>mu</code> et <code>A</code>.
</li><li>La variable <code>mu</code> est un vecteur qui contient la distribution de probabilité initiale sur les lettres.
</li><li>La variable <code>A</code> est une matrice qui donne les probabilités d'une lettre étant donné une autre lettre.
</li><li>La variable <code>secret</code> contient le message à décoder.
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock2">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> <span class="kw3">pickle</span> <span class="kw1">as</span> pkl<br>
<br>
<span class="co1"># si vos fichiers sont dans un repertoire "ressources"</span><br>
<span class="kw1">with</span> <span class="kw2">open</span><span class="br0">(</span><span class="st0">"./ressources/countWar.pkl"</span><span class="sy0">,</span> <span class="st0">'rb'</span><span class="br0">)</span> <span class="kw1">as</span> f:<br>
&nbsp; &nbsp; <span class="br0">(</span>count<span class="sy0">,</span> mu<span class="sy0">,</span> A<span class="br0">)</span> <span class="sy0">=</span> pkl.<span class="me1">load</span><span class="br0">(</span>f<span class="sy0">,</span> encoding<span class="sy0">=</span><span class="st0">'latin1'</span><span class="br0">)</span><br>
<br>
<span class="kw1">with</span> <span class="kw2">open</span><span class="br0">(</span><span class="st0">"./ressources/secret.txt"</span><span class="sy0">,</span> <span class="st0">'r'</span><span class="br0">)</span> <span class="kw1">as</span> f:<br>
&nbsp; &nbsp; secret <span class="sy0">=</span> f.<span class="me1">read</span><span class="br0">(</span><span class="br0">)</span><span class="br0">[</span><span class="nu0">0</span>:-<span class="nu0">1</span><span class="br0">]</span> <span class="co1"># -1 pour supprimer le saut de ligne</span><br>
&nbsp;</div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=2" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">3) Les fonctions de décodage seront représentées comme
 un dictionnaire où la clé et la valeur stockée sont toutes deux de type
 caractère (une lettre est codée/décodée en une autre lettre).
Ecrivez une fonction <strong>swapF</strong> <code>: (char,char) dict -&gt; (char,char) dict</code> qui prend en argument une fonction de décodage <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-56" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.624em, 1000em, 2.575em, -0.526em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="msubsup" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.464em;"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\tau_t</script> et qui retourne une nouvelle fonction de décodage <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-61" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.712em; vertical-align: -0.093em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\tau</script> construite en écheangeant deux lettres <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-64" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.613em, 1000em, 2.567em, -0.51em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="msubsup" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.898em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">c_1</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-69" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.613em, 1000em, 2.567em, -0.51em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.898em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">c_2</script> comme indiqué à la question 3.3 du TD:
</p>
<div class="vspace"></div><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-74" style="width: 6.415em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.076em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.526em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-81" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.464em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\tau(c) = \tau_t(c)</script> pour tout <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-87" style="width: 0.552em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-88"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">c</script> tel que <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-90" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.943em, 1000em, 3.237em, -0.51em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8800;</span><span class="msubsup" id="MathJax-Span-94" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.325em; vertical-align: -0.347em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">c \neq c_1</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-97" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.943em, 1000em, 3.237em, -0.51em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8800;</span><span class="msubsup" id="MathJax-Span-101" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-103" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.325em; vertical-align: -0.347em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">c \neq c_2</script>;
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-104" style="width: 7.481em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.922em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.526em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-105"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.464em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-117"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\tau(c_1) = \tau_t(c_2)</script>;
</li><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-121" style="width: 7.481em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.922em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.526em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-130" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.781em; height: 0px;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.464em;"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.861em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="mn" id="MathJax-Span-136" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\tau(c_2) = \tau_t(c_1)</script>.
</li></ul><p class="vspace">Vous pouvez tester votre fonction avec le dictionnaire suivant :
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock3">
  <div class="sourceblocktext"><div class="python">tau <span class="sy0">=</span> <span class="br0">{</span><span class="st0">'a'</span> : <span class="st0">'b'</span><span class="sy0">,</span> <span class="st0">'b'</span> : <span class="st0">'c'</span><span class="sy0">,</span> <span class="st0">'c'</span> : <span class="st0">'a'</span><span class="sy0">,</span> <span class="st0">'d'</span> : <span class="st0">'d'</span> <span class="br0">}</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=3" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">4) Ecrivez une fonction <strong>decrypt</strong> <code>: string x (char,char) dict -&gt; string</code> qui, étant donné une chaine de caractères <code>mess</code> et une fonction de décodage <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-138" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.712em; vertical-align: -0.093em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">\tau</script>, retourne la chaîne de caractères obtenue par décodage de <code>mess</code> par <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-141" style="width: 0.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.047em, 1000em, 2.853em, -0.526em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math; font-style: italic;">&#964;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.08em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.712em; vertical-align: -0.093em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\tau</script>.
</p>
<p class="vspace">Vous pouvez tester votre fonction avec le code suivant :
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock4">
  <div class="sourceblocktext"><div class="python">tau <span class="sy0">=</span> <span class="br0">{</span><span class="st0">'a'</span> : <span class="st0">'b'</span><span class="sy0">,</span> <span class="st0">'b'</span> : <span class="st0">'c'</span><span class="sy0">,</span> <span class="st0">'c'</span> : <span class="st0">'a'</span><span class="sy0">,</span> <span class="st0">'d'</span> : <span class="st0">'d'</span> <span class="br0">}</span><br>
decrypt <span class="br0">(</span> <span class="st0">"aabcd"</span><span class="sy0">,</span> tau <span class="br0">)</span><br>
decrypt <span class="br0">(</span> <span class="st0">"dcba"</span><span class="sy0">,</span> tau <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=4" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">qui vous produira l'affichage :
</p>
<div class="vspace"></div><pre> &gt;&gt;&gt; decrypt ( "aabcd", tau )
 'bbcad'
 &gt;&gt;&gt; decrypt ( "dcba", tau )
 'dacb'
</pre><p class="vspace">5) Créer un dictionnaire (une table de hashage) associant à chaque caractère son indice dans <code>mu/A</code>. Le code est simplement le suivant:
</p>
<div class="sourceblock " id="sourceblock5">
  <div class="sourceblocktext"><div class="python">chars2index <span class="sy0">=</span> <span class="kw2">dict</span><span class="br0">(</span><span class="kw2">zip</span><span class="br0">(</span>np.<span class="kw3">array</span><span class="br0">(</span><span class="kw2">list</span><span class="br0">(</span>count.<span class="me1">keys</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">,</span> np.<span class="me1">arange</span><span class="br0">(</span><span class="kw2">len</span><span class="br0">(</span>count.<span class="me1">keys</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=5" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><code>chars2index['a']</code> donne simplement accès à l'indice correspondant à la lettre a dans <code>mu</code> ou <code>A</code>
</p>
<p class="vspace">Il est préférable d'utiliser le fichier des indices déjà généré. Lien : <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/fichierHash.pkl" rel="nofollow">fichierHash.pkl</a>
</p>
<p class="vspace"><strong>Attention</strong> aux tables de hash en python qui ne donnent plus accès à des listes de clés: il faut re-créer la liste quand on en a besoin.
</p>
<p class="vspace">6) Ecrivez une fonction <strong>logLikelihood</strong> <code>: string x float np.array x float np.2D-array x (char,int) dict-&gt; string</code> qui, étant donné un message <code>mess</code> (chaîne de caractères), les tableaux <code>mu</code> et <code>A</code> créés à la question 2 à partir de pickle et du dictionnaire précédent <code>chars2index</code>, renvoie la log-vraisemblance du message <code>mess</code> par rapport au modèle bigramme <code>(mu, A)</code>.  
</p>
<p class="vspace">Vous pouvez tester votre fonction avec le code suivant :
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock6">
  <div class="sourceblocktext"><div class="python">logLikelihood<span class="br0">(</span> <span class="st0">"abcd"</span><span class="sy0">,</span> mu<span class="sy0">,</span> A<span class="sy0">,</span> chars2index <span class="br0">)</span><br>
logLikelihood<span class="br0">(</span> <span class="st0">"dcba"</span><span class="sy0">,</span> mu<span class="sy0">,</span> A<span class="sy0">,</span> chars2index <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=6" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">qui vous produira l'affichage :
</p>
<div class="vspace"></div><pre> &gt;&gt;&gt; logLikelihood( "abcd", mu, A, chars2index )
 -24.600258560804818
 &gt;&gt;&gt; logLikelihood( "dcba", mu, A, chars2index )
 -26.274828997400395
</pre><p class="vspace">7) Codez la méthode de Métropolis-Hastings vue en TD sous la forme d'une fonction appelée <strong>MetropolisHastings</strong><code>(mess, mu, A, tau, N, chars2index)</code> en utilisant les fonctions <strong>swapF</strong>, <strong>decrypt</strong> et <strong>logLikelihood</strong>:
</p>
<div class="vspace"></div><ul><li>Le paramètre <code>mess</code> est le message codé.
</li><li>Les paramètres <code>mu</code> et <code>A</code> représentent le modèle de bigrammes.
</li><li>L'argument <code>tau</code> est la fonction de décodage initiale pour démarrer l'algorithme de Métropolis-Hastings.
</li><li>L'argument <code>N</code> est le nombre maximum d'itérations de l'algorithme.
</li><li>L'argument <code>chars2index</code> a déjà été vu.
</li></ul><p class="vspace">La méthode est une simple boucle où on fait les étapes suivantes :
</p><ul><li>tirage d'une nouvelle fonction de décodage <code>tau'</code> en appliquant <code>swapF</code> avec pour paramètre la fonction de décodage courante <code>tau</code>
</li><li>calcul de la log-vraisemblance du message décodé grâce à <code>tau'</code>
</li><li>tirage pour accepter ou non la transition vers <code>tau'</code> selon le rapport des vraisemblances
</li><li>si la transition est acceptée, sauvegarder le message décodé avec la plus haute vraisemblance.
</li></ul><p class="vspace">La fonction retourne le message décodé le 
plus vraisemblable.
Vous afficherez la log-vraisemblance à chaque fois qu'elle est améliorée
 et le message décodé correspondant pour pouvoir observer l'évolution de
 l'algorithme.
</p>
<p class="vspace">Afin de tester votre fonction, vous pourrez exécuter le code suivant :
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock7">
  <div class="sourceblocktext"><div class="python"><span class="kw1">def</span> identityTau <span class="br0">(</span>count<span class="br0">)</span>:<br>
&nbsp; &nbsp; tau <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span> <br>
&nbsp; &nbsp; <span class="kw1">for</span> k <span class="kw1">in</span> <span class="kw2">list</span><span class="br0">(</span>count.<span class="me1">keys</span> <span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; tau<span class="br0">[</span>k<span class="br0">]</span> <span class="sy0">=</span> k<br>
&nbsp; &nbsp; <span class="kw1">return</span> tau<br>
MetropolisHastings<span class="br0">(</span> secret2<span class="sy0">,</span> mu<span class="sy0">,</span> A<span class="sy0">,</span> identityTau <span class="br0">(</span>count<span class="br0">)</span><span class="sy0">,</span> <span class="nu0">10000</span><span class="sy0">,</span> chars2index<span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=7" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><strong>Attention</strong>: ce code (un peu bête) ne fonctionne pas avec <code>secret.txt</code>, seulement avec <code>secret2.txt</code>!
</p>
<p class="vspace">7) Pour accélérer les calculs, nous allons partir 
d'une fonction de décodage prenant les fréquences d'occurences des 
lettres (c'est-à-dire la lettre la plus fréquente du message codé sera 
décodée vers la lettre la plus fréquente observée dans le roman de 
Tolstoï; ensuite la deuxième lettre la plus fréquente du message codé 
sera décodée vers la deuxième lettre la plus fréquente observée du 
roman; et ainsi de suite...)
Vous pouvez utiliser le code suivant pour construire une telle fonction 
de décodage, nommée ici <code>tau_init</code>.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock8">
  <div class="sourceblocktext"><div class="python"><span class="co1"># ATTENTION: mu = proba des caractere init, pas la proba stationnaire</span><br>
<span class="co1"># =&gt; trouver les caractères fréquents = sort (count) !!</span><br>
<span class="co1"># distribution stationnaire des caracteres</span><br>
freqKeys <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="kw2">list</span><span class="br0">(</span>count.<span class="me1">keys</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><br>
freqVal &nbsp;<span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="kw2">list</span><span class="br0">(</span>count.<span class="me1">values</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><br>
<span class="co1"># indice des caracteres: +freq =&gt; - freq dans la references</span><br>
rankFreq <span class="sy0">=</span> <span class="br0">(</span>-freqVal<span class="br0">)</span>.<span class="me1">argsort</span><span class="br0">(</span><span class="br0">)</span><br>
<br>
<span class="co1"># analyse mess. secret: indice les + freq =&gt; - freq</span><br>
cles <span class="sy0">=</span> np.<span class="kw3">array</span><span class="br0">(</span><span class="kw2">list</span><span class="br0">(</span><span class="kw2">set</span><span class="br0">(</span>secret2<span class="br0">)</span><span class="br0">)</span><span class="br0">)</span> <span class="co1"># tous les caracteres de secret2</span><br>
rankSecret <span class="sy0">=</span> np.<span class="me1">argsort</span><span class="br0">(</span>-np.<span class="kw3">array</span><span class="br0">(</span><span class="br0">[</span>secret2.<span class="me1">count</span><span class="br0">(</span>c<span class="br0">)</span> <span class="kw1">for</span> c <span class="kw1">in</span> cles<span class="br0">]</span><span class="br0">)</span><span class="br0">)</span><br>
<span class="co1"># ATTENTION: 37 cles dans secret, 77 en général... On 
ne code que les caractères les plus frequents de mu, tant pis pour les 
autres</span><br>
<span class="co1"># alignement des + freq dans mu VS + freq dans secret</span><br>
tau_init <span class="sy0">=</span> <span class="kw2">dict</span><span class="br0">(</span><span class="br0">[</span><span class="br0">(</span>cles<span class="br0">[</span>rankSecret<span class="br0">[</span>i<span class="br0">]</span><span class="br0">]</span><span class="sy0">,</span> freqKeys<span class="br0">[</span>rankFreq<span class="br0">[</span>i<span class="br0">]</span><span class="br0">]</span><span class="br0">)</span> <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span><span class="br0">(</span><span class="kw2">len</span><span class="br0">(</span>rankSecret<span class="br0">)</span><span class="br0">)</span><span class="br0">]</span><span class="br0">)</span><br>
<br>
MetropolisHastings<span class="br0">(</span>secret2<span class="sy0">,</span> mu<span class="sy0">,</span> A<span class="sy0">,</span> tau_init<span class="sy0">,</span> <span class="nu0">50000</span><span class="sy0">,</span> chars2index<span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=sourceblock&amp;num=8" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Le message sera normalement intelligible lorsque vous arrivez à une log-vraisemblance de plus de <code>-3090</code>. Toutefois, il reste en général des erreurs dans la traduction... A quel niveau?
</p>
<div class="vspace"></div><hr>
<h2 style="background-color: #e6d8c0;">Partie optionnelle</h2>
<hr>
<div class="vspace"></div><h2><span style="color: blue;"> Estimation de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-144" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.56em; height: 0px; font-size: 123%;"><span style="position: absolute; clip: rect(2.102em, 1000em, 2.721em, -0.246em); top: -2.622em; left: 0em;"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math; font-style: italic;">&#960;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.622em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.616em; vertical-align: -0.05em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\pi</script> par MCMC</span></h2>
<p>Codez la méthode <strong>MCMC</strong> <code>int x float -&gt; float</code> vue en TD en utilisant la fonction <strong>tirage</strong> de l'exercice précédent.
Votre méthode prendra en paramètre la longueur <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-147" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-148"><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">N</script> de la chaîne de Markov générée par l'algorithme (le nombre d'itérations de l'algorithme) ainsi que le déplacement <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-150" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.034em, -0.583em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-151"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.954em; vertical-align: -0.321em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">p</script> maximal (en abscisse et en ordonnée) que l'on peut effectuer à chaque étape.
</p>
</div>

				</div>
			</div>

			<div id="sidebar">
				<!--PageSearchFmt-->
				<div class="boxy short">
					<div id="search">
						<h3>Search</h3>

						<form id="searchform" action="http://mapsi.lip6.fr/pmwiki.php" method="get">
						<fieldset>
							<input type="hidden" name="n" value="Cours.TME9">
							<input type="hidden" name="action" value="search">
							<input class="searchBox" type="text" id="q" name="q">
							<input class="searchButton" type="submit" value="Go">
						</fieldset>
						</form>
					</div>
				</div>
				<!--/PageSearchFmt-->

				<!--PageRightFmt-->
				<div class="boxy tall">
					<p class="sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.TutoPythonJN">Tutoriel numpy</a>
</p>
<div class="vspace"></div>

				</div>
				<!--/PageRightFmt-->
			</div>
		</div>

		<div id="options-container">
			<!--PageOptionsFmt-->
			<div id="options">
				<h2>Options:</h2>
				<ul id="option_size">
					<li title="size: fixed" id="option_size_fixed" class="fixed"><a><span>fixed</span></a></li>
					<li title="size: fluid" id="option_size_fluid" class="fluid"><a><span>fluid</span></a></li>
				</ul>

				<ul id="option_color">
					<li title="color: orange" id="option_color_orange" class="orange"><a><span>orange</span></a></li>
					<li title="color: blue" id="option_color_blue" class="blue"><a><span>blue</span></a></li>
					<li title="color: green" id="option_color_green" class="green"><a><span>green</span></a></li>
					<li title="color: pink" id="option_color_pink" class="pink"><a><span>pink</span></a></li>
					<li title="color: cyan" id="option_color_cyan" class="cyan"><a><span>cyan</span></a></li>
					<li title="color: red" id="option_color_red" class="red"><a><span>red</span></a></li>
					<li title="color: violet" id="option_color_violet" class="violet"><a><span>violet</span></a></li>
				</ul>
			</div>
			<!--/PageOptionsFmt-->

			<!--PageActionFmt-->
			<div class="pageactions">
				<ul><li class="browse">      <a accesskey="" rel="nofollow" class="selflink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9">View</a>
</li><li class="edit">      <a accesskey="e" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=edit">Edit</a>
</li><li class="diff">   <a accesskey="h" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=diff">History</a>
</li><li class="print">     <a accesskey="" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME9?action=print">Print</a>
</li></ul>

			</div>
			<!--/PageActionFmt-->
		</div>

		<div id="footer">
			<!--PageFooterFmt-->
				<div class="footer"><p>Page last modified on December 12, 2017, at 04:44 PM EST
</p>
</div>
			<!--/PageFooterFmt-->
			<p id="credits"><a href="http://evil.che.lu/projects/skittlish">Skittlish</a> theme adapted by <a href="http://solidgone.org/Skins/">David Gilbert</a>, powered by <a href="http://pmwiki.com/">PmWiki</a></p>
		</div>
	</div>
<!--HTMLFooter-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Main, sans-serif;"></div></div></body></html>