<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
	<title>MAPSI Cours/TME 5</title>
	<link href="MAPSI%20Cours_TME%205_fichiers/base.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">g_DefaultStyle="fixed blue";</script>
	<script type="text/javascript" src="MAPSI%20Cours_TME%205_fichiers/app.js"></script>
<!--[if IE]>
<link href="http://mapsi.lip6.fr/pub/skins/skittlish/base_ie.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--HTMLHeader--><style type="text/css"><!--
.subpage h1, h1.subpage { margin:0px; margin-top:1.2em; margin-bottom:8px; 
    color: #006633;
	font-size: 150%; }
p.subpage { float: right; }
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#siteheader .sitetitle a{height:0px; background: url(http://example.com/mylogo.gif) left top no-repeat} #siteheader .sitetitle a, #siteheader .sitetag{padding-left: 0px} #siteheader .sitetag{margin-top: 44px}
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python .de1, .python .de2 {font-family: monospace; font-weight: normal;}
.python  {font-family:monospace;}
.python .imp {font-weight: bold; color: red;}
.python li, .python .li1 {font-family: monospace; color: black; font-weight: normal;}
.python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python .li2 {font-weight: bold;}
.python .kw1 {color: #ff7700;font-weight:bold;}
.python .kw2 {color: #008000;}
.python .kw3 {color: #dc143c;}
.python .kw4 {color: #0000cd;}
.python .co1 {color: #808080; font-style: italic;}
.python .coMULTI {color: #808080; font-style: italic;}
.python .es0 {color: #000099; font-weight: bold;}
.python .br0 {color: black;}
.python .sy0 {color: #66cc66;}
.python .st0 {color: #483d8b;}
.python .nu0 {color: #ff4500;}
.python .me1 {color: black;}
.python .ln-xtra, .python li.ln-xtra, .python div.ln-xtra {background-color: #ffc;}
.python span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  color: #000000;
  background-color: #fafafa;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript" src="MAPSI%20Cours_TME%205_fichiers/MathJax.js">MathJax.Hub.Config({
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: { inlineMath: [ ['{\$','\$}'] ], displayMath: [ ['{\$\$','\$\$}'] ] } });</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>  <meta name="robots" content="index,follow">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://mapsi.lip6.fr/pub/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="fixed violet"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
	loadPreferences()
//]]>
</script>

	<div id="wrapper">
		<div id="header" class="clearfix">
			<div id="siteheader" class="clearfix">
				<!--PageHeaderFmt-->
				<h1 class="sitetitle"><a class="urllink" href="http://mapsi.lip6.fr/pmwiki.php" rel="nofollow">MAPSI</a></h1>
<div class="sitetag">Modèles et Algorithmes de Probabilités et Statistiques pour l'Informatique
</div>

				<!--/PageHeaderFmt-->
			</div>

			<!--PageTabsFmt-->
			<div id="menu">
				
			</div>
			<!--/PageTabsFmt-->
		</div>

		<div id="contentwrapper" class="clearfix">
			<div id="content">
				<div id="innerwrapper">
					<!--PageTitleGroupFmt-->
					<a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours" class="pagegroup">Cours</a>
					<!--/PageTitleGroupFmt-->
					<!--PageTitleFmt--><!--/PageTitleFmt-->

					<!--PageText-->
<div id="wikitext">
<div class="vspace"></div><h1>Indépendances conditionnelles et réseaux bayésiens</h1>
<h2 style="background-color: #e6d8c0;">Partie obligatoire</h2>
<hr>
<p class="vspace">Dans ce TME, l'objectif est d'apprendre des réseaux bayésiens à partir de bases de données. Hormis la base <strong>asia</strong>, un exemple jouet relativement petit qui vous permettra de mettre au point les différents algorithmes du TME, et <strong>car</strong>, les autres bases correspondront à des distributions de probabilité de tailles raisonnables :
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">nom de la base</th><th align="center">provenance</th><th align="center">nombre d'événements élémentaires</th></tr>
<tr><td align="center">asia</td><td align="center"> <a target="_blank" class="urllink" href="http://www.bnlearn.com/bnrepository/" rel="nofollow">BN repository</a></td><td align="center">256</td></tr>
<tr><td align="center">alarm</td><td align="center"> <a target="_blank" class="urllink" href="http://www.bnlearn.com/bnrepository/" rel="nofollow">BN repository</a></td><td align="center">10<sup>16</sup></td></tr>
<tr><td align="center">adult</td><td align="center"> <a target="_blank" class="urllink" href="https://archive.ics.uci.edu/ml/datasets/Adult" rel="nofollow">UCI machine learning repository</a></td><td align="center">10<sup>12</sup></td></tr>
<tr><td align="center">car</td><td align="center"> <a target="_blank" class="urllink" href="https://archive.ics.uci.edu/ml/datasets/Car+Evaluation" rel="nofollow">UCI machine learning repository</a></td><td align="center">6912</td></tr>
<tr><td align="center">agaricus-lepiota</td><td align="center"><a class="urllink" href="https://archive.ics.uci.edu/ml/datasets/Mushroom" rel="nofollow">UCI machine learning repository</a></td><td align="center">10<sup>16</sup></td></tr>
</tbody></table>
<p class="vspace">Apprendre un réseau bayésien consiste à apprendre sa 
structure graphique ainsi que les paramètres de ses distributions de 
probabilité conditionnelles. Pour réaliser la deuxième tâche, il suffit 
d'estimer les paramètres de chaque distribution conditionnelle par 
maximum de vraisemblance, comme vous l'avez fait dans le TME 3. Ici, 
nous nous focaliserons donc plutôt sur l'apprentissage de structure. 
Celle-ci reflétant des indépendances conditionnelles entre variables 
aléatoires, vous devrez exploiter des tests d'indépendance du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">\chi^2</script> afin d'obtenir des structures graphiques les moins denses possibles (en termes de nombres d'arcs). Ainsi, <strong>alarm</strong> représente une distribution jointe de plus de 10<sup>16</sup>
 événements élémentaires mais, quand cette distribution est décomposée 
grâce au graphe ci-dessous (les noeuds représentant les variables 
aléatoires), elle peut être décrite (sans perte d'informations) à l'aide
 de seulement 752 paramètres. Comme nous l'avons vu en cours, cette 
représentation permet également d'effectuer très rapidement des calculs 
probabilistes.
</p>
<div class="vspace"></div><div style="text-align: center;">   <img src="MAPSI%20Cours_TME%205_fichiers/2014_tme5_alarm.png" alt="" title="" width="500px"></div>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">1. Lecture des données</span></strong></span>
</p>
<p class="vspace">Dans le code ci-dessous, la fonction <strong>read_csv</strong> <code>: string -&gt; (string np.array, int np.2D-array, dico{string -&gt; int} np.array)</code>
 vous permettra de lire les données des bases sur lesquelles vous allez 
travailler, et de les organiser sous une forme adéquate. Par exemple, 
une base de données est un fichier de la forme:
</p>
<div class="vspace"></div><pre> X_0,X_1,X_2,X_3
 haut,gauche,petit,bas
 bas,droite,grand,gauche
 bas,gauche,moyen,bas
</pre><p class="vspace">Dans cette base, nous avons 4 variables 
aléatoires nommées X_0, X_1, X_2, et X_3, et 3 enregistrements qui 
représentent des instanciations (observées) de ces 4 variables. Ainsi, 
X_0 a pour valeurs haut, bas et bas, X_1 a pour valeurs gauche, droite, 
gauche, <em>etc</em>.
</p>
<p class="vspace">La fonction <strong>read_csv</strong> prend en argument le nom d'un fichier CSV contenant une base de données et renvoie un triplet composé de :
</p>
<div class="vspace"></div><ul><li>1 tableau numpy de strings contenant 
les noms des variables aléatoires. Par exemple, pour la base ci-dessus, 
ce tableau correspond à:
</li></ul><div class="vspace"></div><pre> n.array (['X_0', 'X_1', 'X_2', 'X_3'])
</pre><div class="vspace"></div><ul><li>un tableau numpy 2D contenant 
les données du fichier CSV encodées sous forme numérique (les valeurs 
des variables aléatoires sont transformées en nombres entiers): chaque 
ligne de ce tableau représente les intanciations d'une variable 
aléatoire et chaque colonne représente un enregistrement de la base de 
données, c'est-à-dire une instanciation/observation de toutes les 
variables aléatoires. Pour la base ci-dessus, nous obtiendrions le 
tableau ci-dessous (la signification des nombres est indiquée dans le 
dictionnaire précisé plus bas):
</li></ul><div class="vspace"></div><pre> np.array ( [ [0, 1, 1],    # instanciations de la variable X_0
              [0, 1, 0],    # instanciations de la variable X_1
              [0, 1, 2],    # instanciations de la variable X_2
              [0, 1, 0]] )  # instanciations de la variable X_3
</pre><div class="vspace"></div><div class="indent">Ainsi, les valeurs 
observées de la première variable aléatoire X_0 correspondent à la 
première ligne du tableau (0, 1 et 1). La première colonne correspond à 
une observation de toutes les variables (X_0=0,X_1=0,X_2=0,X_3=0). C'est
 essentiellement sur ce tableau numpy que vous travaillerez dans ce TME.
</div><div class="vspace"></div><ul><li>un tableau numpy de 
dictionnaires faisant la correspondance, pour chaque variable aléatoire,
 entre l'encodage numérique du tableau 2D ci-dessus et les données du 
fichier CSV (le 1er dictionnaire correspond à la variable de la 1ère 
colonne du CSV, le 2ème dictionnaire à celle de la 2ème colonne, <em>etc</em>.). Ainsi, le dictionnaire est égal à :
</li></ul><div class="vspace"></div><pre> np.array( [ {'haut': 0, 'bas': 1},                  # encodage variable X_0
             {'gauche': 0, 'droite': 1},             # encodage variable X_1
             {'petit': 0, 'grand': 1, 'moyen': 2 },  # encodage variable X_2
             {'bas': 0, 'gauche': 1} ] )             # encodage variable X_3
</pre><div class="vspace"></div><div class="indent">On peut ainsi 
reconstituer le CSV d'origine. Par exemple, la première colonne du 
tableau 2D ci-dessus, qui est égale à 0,0,0,0 correspond à 
haut,gauche,petit,bas: "haut" correspondant au 0 de la première variable
 aléatoire, "gauche" correspondant au 0 de la 2ème variable, <em>etc</em>.
</div><p class="vspace">Téléchargez le fichier <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2015_tme5_asia.csv" rel="nofollow">2015_tme5_asia.csv</a> et lisez-le à l'aide de la fonction <strong>read_csv</strong> ci-dessous: la dernière instruction, <code>names, data, dico = read_csv ( "2015_tme5_asia.csv" )</code>, vous permettra de récupérer, séparément, les trois champs du triplet renvoyé par la fonction <strong>read_csv</strong>.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock1">
  <div class="sourceblocktext"><div class="python"><span class="co1"># -*- coding: utf-8 -*-</span><br>
<br>
<span class="kw1">import</span> numpy <span class="kw1">as</span> np<br>
<br>
<span class="co1"># fonction pour transformer les données brutes en nombres de 0 à n-1</span><br>
<span class="kw1">def</span> translate_data <span class="br0">(</span> data <span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="co1"># création des structures de données à retourner</span><br>
&nbsp; &nbsp; nb_variables <span class="sy0">=</span> data.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><br>
&nbsp; &nbsp; nb_observations <span class="sy0">=</span> data.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> - <span class="nu0">1</span> <span class="co1"># - nom variable</span><br>
&nbsp; &nbsp; res_data <span class="sy0">=</span> np.<span class="me1">zeros</span> <span class="br0">(</span> <span class="br0">(</span>nb_variables<span class="sy0">,</span> nb_observations <span class="br0">)</span><span class="sy0">,</span> <span class="kw2">int</span> <span class="br0">)</span><br>
&nbsp; &nbsp; res_dico <span class="sy0">=</span> np.<span class="me1">empty</span> <span class="br0">(</span> nb_variables<span class="sy0">,</span> dtype<span class="sy0">=</span><span class="kw2">object</span> <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># pour chaque variable, faire la traduction</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> nb_variables <span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; res_dico<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> <span class="br0">{</span><span class="br0">}</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; index <span class="sy0">=</span> <span class="nu0">0</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> j <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> <span class="nu0">1</span><span class="sy0">,</span> nb_observations + <span class="nu0">1</span> <span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># si l'observation n'existe pas dans le dictionnaire, la rajouter</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> data<span class="br0">[</span>i<span class="sy0">,</span>j<span class="br0">]</span> <span class="kw1">not</span> <span class="kw1">in</span> res_dico<span class="br0">[</span>i<span class="br0">]</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; res_dico<span class="br0">[</span>i<span class="br0">]</span>.<span class="me1">update</span> <span class="br0">(</span> <span class="br0">{</span> data<span class="br0">[</span>i<span class="sy0">,</span>j<span class="br0">]</span> : index <span class="br0">}</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; index +<span class="sy0">=</span> <span class="nu0">1</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1"># rajouter la traduction dans le tableau de données à retourner</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; res_data<span class="br0">[</span>i<span class="sy0">,</span>j-<span class="nu0">1</span><span class="br0">]</span> <span class="sy0">=</span> res_dico<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>data<span class="br0">[</span>i<span class="sy0">,</span>j<span class="br0">]</span><span class="br0">]</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> <span class="br0">(</span> res_data<span class="sy0">,</span> res_dico <span class="br0">)</span><br>
<br>
<br>
<span class="co1"># fonction pour lire les données de la base d'apprentissage</span><br>
<span class="kw1">def</span> read_csv <span class="br0">(</span> filename <span class="br0">)</span>:<br>
&nbsp; &nbsp; data <span class="sy0">=</span> np.<span class="me1">loadtxt</span> <span class="br0">(</span> filename<span class="sy0">,</span> delimiter<span class="sy0">=</span><span class="st0">','</span><span class="sy0">,</span> dtype<span class="sy0">=</span>np.<span class="kw2">str</span> <span class="br0">)</span>.<span class="me1">T</span><br>
&nbsp; &nbsp; names <span class="sy0">=</span> data<span class="br0">[</span>:<span class="sy0">,</span><span class="nu0">0</span><span class="br0">]</span>.<span class="kw3">copy</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; data<span class="sy0">,</span> dico <span class="sy0">=</span> translate_data <span class="br0">(</span> data <span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> names<span class="sy0">,</span> data<span class="sy0">,</span> dico<br>
<br>
<span class="co1"># names : tableau contenant les noms des variables aléatoires</span><br>
<span class="co1"># data &nbsp;: tableau 2D contenant les instanciations des variables aléatoires</span><br>
<span class="co1"># dico &nbsp;: tableau de dictionnaires contenant la correspondance (valeur de variable -&gt; nombre)</span><br>
names<span class="sy0">,</span> data<span class="sy0">,</span> dico <span class="sy0">=</span> read_csv <span class="br0">(</span> <span class="st0">"2015_tme5_asia.csv"</span> <span class="br0">)</span> &nbsp; &nbsp;</div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=1" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><br>
<span style="font-size:120%"><strong><span style="color: blue;">2. Statistique du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6" style="width: 1.411em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.099em; height: 0px; font-size: 127%;"><span style="position: absolute; clip: rect(1.214em, 1000em, 2.551em, -0.424em); top: -2.197em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(2.005em, 1000em, 2.951em, -0.424em); top: -2.597em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.597em;"></span></span><span style="position: absolute; top: -2.76em; left: 0.649em;"><span class="mn" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.397em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.197em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.445em; vertical-align: -0.323em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\chi^2</script> conditionnel</span></strong></span>
</p>
<p class="vspace">Soit deux variables aléatoires <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-11" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">X</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">Y</script>. Appelons <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-17" style="width: 2.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.632em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="msubsup" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 1.622em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-21"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">N_{xy}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-25" style="width: 1.694em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.329em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.575em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="msubsup" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 1.319em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.212em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">N_x</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-30" style="width: 1.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.269em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="msubsup" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">N_y</script>, respectivement, le nombre d'occurrences du couple <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-35" style="width: 8.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.587em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-36"><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">(X=x,Y=y)</script> et des singletons <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-46" style="width: 3.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.78em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.976em, 1000em, 3.033em, -0.518em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.027em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">X=x</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-51" style="width: 3.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.599em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.976em, 1000em, 3.227em, -0.514em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.271em; vertical-align: -0.334em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">Y=y</script> dans la base de données. Alors, comme indiqué dans le cours 5, la statistique du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-56" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="msubsup" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">\chi^2</script> de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-61" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">X</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-64" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">Y</script> est égale à :
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-14-Frame" style=""><nobr><span class="math" id="MathJax-Span-67" style="width: 17.684em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.02em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.171em, 1000em, 4.534em, -0.519em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-68"><span class="msubsup" id="MathJax-Span-69"><span style="display: inline-block; position: relative; width: 1.948em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.813em, 1000em, 2.796em, -0.525em); top: -2.159em; left: 0.604em;"><span class="texatom" id="MathJax-Span-72"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-78" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.984em, 1000em, 2.767em, -0.519em); top: -1.428em; left: 0.514em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="munderover" id="MathJax-Span-81" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.984em, 1000em, 2.904em, -0.529em); top: -1.428em; left: 0.544em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-84" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 7.265em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.46em, 1000em, 4.819em, -0.364em); top: -5.129em; left: 50%; margin-left: -3.573em;"><span class="msubsup" id="MathJax-Span-85"><span style="display: inline-block; position: relative; width: 7.145em; height: 0px;"><span style="position: absolute; clip: rect(2.537em, 1000em, 4.698em, -0.364em); top: -3.868em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="mo" id="MathJax-Span-87" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-88"><span style="display: inline-block; position: relative; width: 1.622em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-90"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-93" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mfrac" id="MathJax-Span-95" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.867em, -0.522em); top: -3.11em; left: 50%; margin-left: -1.148em;"><span class="mrow" id="MathJax-Span-96"><span class="msubsup" id="MathJax-Span-97"><span style="display: inline-block; position: relative; width: 0.899em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="mi" id="MathJax-Span-99" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-102" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="mi" id="MathJax-Span-103" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.071em; left: 50%; margin-left: -0.302em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 2.416em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="mo" id="MathJax-Span-105" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; top: -3.354em; left: 6.708em;"><span class="mn" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(2.692em, 1000em, 4.576em, -0.544em); top: -2.882em; left: 50%; margin-left: -1.328em;"><span class="mfrac" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.867em, -0.522em); top: -3.11em; left: 50%; margin-left: -1.148em;"><span class="mrow" id="MathJax-Span-108"><span class="msubsup" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 0.899em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="mi" id="MathJax-Span-111" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="msubsup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="mi" id="MathJax-Span-115" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.071em; left: 50%; margin-left: -0.302em;"><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 2.416em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 7.265em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 5.192em; vertical-align: -1.981em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">\chi^2_{X,Y} = \sum_x\sum_y\frac{\left(N_{xy} - \frac{N_x \times N_y}{N}\right)^2}{\frac{N_x \times N_y}{N}}</script>
</p>
<p class="vspace">où <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-117" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">N</script> représente le nombre de lignes de la base de données. Cette formule permet de tester l'indépendance entre les deux variables <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-120" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">X</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-123" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">Y</script>. On peut aisément généraliser celle-ci pour tester des indépendances conditionnellement à un ensemble de variables <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-126" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-127"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\mathbf{Z}</script>:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" style=""><nobr><span class="math" id="MathJax-Span-131" style="width: 21.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.223em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(0.171em, 1000em, 4.64em, -0.519em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-132"><span class="msubsup" id="MathJax-Span-133"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-141"><span class="mrow" id="MathJax-Span-142"><span class="mo" id="MathJax-Span-143" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-148" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.984em, 1000em, 2.767em, -0.519em); top: -1.428em; left: 0.514em;"><span class="mi" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="munderover" id="MathJax-Span-151" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.984em, 1000em, 2.904em, -0.529em); top: -1.428em; left: 0.544em;"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="munderover" id="MathJax-Span-154" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px;"><span style="position: absolute; clip: rect(2.736em, 1000em, 4.499em, -0.489em); top: -3.868em; left: 0em;"><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; clip: rect(1.982em, 1000em, 2.759em, -0.521em); top: -1.428em; left: 0.544em;"><span class="texatom" id="MathJax-Span-156"><span class="mrow" id="MathJax-Span-157"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-161" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 8.111em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.46em, 1000em, 4.819em, -0.364em); top: -5.129em; left: 50%; margin-left: -3.996em;"><span class="msubsup" id="MathJax-Span-162"><span style="display: inline-block; position: relative; width: 7.991em; height: 0px;"><span style="position: absolute; clip: rect(2.537em, 1000em, 4.698em, -0.364em); top: -3.868em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="mo" id="MathJax-Span-164" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="msubsup" id="MathJax-Span-165"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mfrac" id="MathJax-Span-175" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 2.9em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.867em, -0.522em); top: -3.11em; left: 50%; margin-left: -1.39em;"><span class="mrow" id="MathJax-Span-176"><span class="msubsup" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-178" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-182"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="msubsup" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-191"><span class="mrow" id="MathJax-Span-192"><span class="mi" id="MathJax-Span-193" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000em, 4.276em, -0.522em); top: -3.582em; left: 50%; margin-left: -0.419em;"><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 2.9em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span class="mo" id="MathJax-Span-201" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.868em;"></span></span><span style="position: absolute; top: -3.354em; left: 7.554em;"><span class="mn" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(2.692em, 1000em, 4.682em, -0.544em); top: -2.882em; left: 50%; margin-left: -1.57em;"><span class="mfrac" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 2.9em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.867em, -0.522em); top: -3.11em; left: 50%; margin-left: -1.39em;"><span class="mrow" id="MathJax-Span-204"><span class="msubsup" id="MathJax-Span-205"><span style="display: inline-block; position: relative; width: 1.141em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-207"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-210"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span class="mo" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-216"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-219"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(3.324em, 1000em, 4.276em, -0.522em); top: -3.582em; left: 50%; margin-left: -0.419em;"><span class="msubsup" id="MathJax-Span-222"><span style="display: inline-block; position: relative; width: 0.839em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.659em, -0.522em); top: -2.478em; left: 0em;"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; top: -2.251em; left: 0.544em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="texatom" id="MathJax-Span-226"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-size: 50%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.357em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 2.9em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.988em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.269em, -0.544em); top: -1.308em; left: 0em;"><span style="border-left: 8.111em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.088em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 5.326em; vertical-align: -2.115em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">\chi^2_{X,Y|\mathbf{Z}} = \sum_x\sum_y\sum_{\mathbf{z}}\frac{\left(N_{xy\mathbf{z}} - \frac{N_{x\mathbf{z}} \times N_{y\mathbf{z}}}{N_{\mathbf{z}}}\right)^2}{\frac{N_{x\mathbf{z}} \times N_{y\mathbf{z}}}{N_{\mathbf{z}}}}</script>
</p>
<p class="vspace">où <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-229" style="width: 2.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-233"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-237"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">N_{xy\mathbf{z}}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-240" style="width: 2.151em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.692em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.575em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-241"><span class="msubsup" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.682em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-247"><span class="mrow" id="MathJax-Span-248"><span class="mi" id="MathJax-Span-249" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.212em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">N_{x\mathbf{z}}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-250" style="width: 2.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.632em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="msubsup" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 1.622em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-254"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="mi" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">N_{y\mathbf{z}}</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-260" style="width: 1.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.269em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.567em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-261"><span class="msubsup" id="MathJax-Span-262"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-264"><span class="mrow" id="MathJax-Span-265"><span class="texatom" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mi" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">N_{\mathbf{z}}</script> représentent, respectivement, le nombre d'occurrences du triplet <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-269" style="width: 12.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.548em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.332em, -0.45em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-270"><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-280" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-284" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">(X=x,Y=y,\mathbf{Z} = \mathbf{z})</script>, des couples <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-288" style="width: 8.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.526em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.332em, -0.45em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-295" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-298" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-299" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-300"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">(X=x,\mathbf{Z} = \mathbf{z})</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-303" style="width: 8.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.345em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.332em, -0.45em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-304"><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-310" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-314" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-315"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">(Y=y,\mathbf{Z} = \mathbf{z})</script>, et du singleton <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-318" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.033em, 1000em, 3.082em, -0.48em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-319"><span class="texatom" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-324" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\mathbf{Z} = \mathbf{z}</script>. Ainsi, si <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-327" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-328"><span class="texatom" id="MathJax-Span-329"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">\mathbf{Z}</script> est un ensemble de 3 variables aléatoires <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-332" style="width: 4.968em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.928em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-333"><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">B</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.045em;"></span></span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">(A,B,C)</script>, les valeurs <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-341" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.215em, 1000em, 3.022em, -0.512em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-342"><span class="texatom" id="MathJax-Span-343"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.712em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\mathbf{z}</script> seront des triplets <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-31-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-346" style="width: 3.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.082em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-347"><span class="mo" id="MathJax-Span-348" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-349" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-352" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">(a,b,c)</script>.
</p>
<p class="vspace">Afin de vous aider à calculer ces <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-355" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-356"><span class="msubsup" id="MathJax-Span-357"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">\chi^2</script>, vous pourrez utiliser la fonction <strong>create_contingency_table</strong> <code>: int np.2D-array x dico{string -&gt; int} np.array x int x int x int list -&gt; (int, np.2D-array) np.array</code> ci-dessous. Celle-ci prend en argument le tableau 2D numpy <code>data</code> et le tableau de dictionnaires <code>dico</code> retournés à la fin de la question 1, ainsi que l'index <code>x</code> d'une variable aléatoire (0 = 1ère variable aléatoire (celle de la 1ère ligne de <code>data</code>), 1 = 2ème variable, <em>etc.</em>), l'index <code>y</code> d'une autre variable et une liste <code>z</code> d'index d'autres variables aléatoires. Elle renvoie un tableau de couples (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-360" style="width: 5.882em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.653em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.309em, -0.513em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="msubsup" id="MathJax-Span-362"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-364"><span class="mrow" id="MathJax-Span-365"><span class="texatom" id="MathJax-Span-366"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-369" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-370" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 2.554em; height: 0px;"><span style="position: absolute; clip: rect(1.801em, 1000em, 2.84em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.605em;"><span class="texatom" id="MathJax-Span-372"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="mo" id="MathJax-Span-377" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-378"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.459em; vertical-align: -0.438em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">N_{\mathbf{z}}, T_{X,Y,\mathbf{z}})</script>, pour tous les <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-382" style="width: 3.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.417em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.033em, 1000em, 3.122em, -0.512em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="texatom" id="MathJax-Span-384"><span class="mrow" id="MathJax-Span-385"><span class="mi" id="MathJax-Span-386" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8712;</span><span class="texatom" id="MathJax-Span-388" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.067em; vertical-align: -0.127em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">\mathbf{z} \in\mathbf{Z}</script>, où:
</p>
<div class="vspace"></div><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-35-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-391" style="width: 1.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.269em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.567em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-395"><span class="mrow" id="MathJax-Span-396"><span class="texatom" id="MathJax-Span-397"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">N_{\mathbf{z}}</script> représente le nombre d'occurences de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-36-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-400" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.976em, 1000em, 3.033em, -0.486em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-401"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.027em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">Z=z</script> dans la base de données. Par exemple, si la base de données est la suivante :
</li></ul><div class="vspace"></div><pre> X_0,X_1,X_2,X_3
 haut,gauche,petit,bas
 bas,droite,grand,gauche
 bas,gauche,moyen,bas
</pre><div class="vspace"></div><div class="indent">nous avons vu plus haut que le tableau <code>data</code> est égal à :
</div><div class="vspace"></div><pre> data = np.array ( [ [0, 1, 1],    # instanciations de la variable X_0
                     [0, 1, 0],    # instanciations de la variable X_1
                     [0, 1, 2],    # instanciations de la variable X_2
                     [0, 1, 0]] )  # instanciations de la variable X_3
</pre><div class="vspace"></div><div class="indent">L'application de <strong>create_contingency_table</strong> <code>( data, dico, 0, 2, [3] )</code> renverra le tableau:
</div><div class="vspace"></div><pre> resultat = array([ (2, array([[ 1.,  0.,  0.],        # Z = 0 =&gt; N_{Z=0} = 2
                               [ 0.,  0.,  1.]])),
                    (1, array([[ 0.,  0.,  0.],        # Z = 1 =&gt; N_{Z=1} = 1
                               [ 0.,  1.,  0.]])) ])
</pre><div class="vspace"></div><div class="indent">En effet le paramètre <code>[3]</code> indique que <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-405" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-406"><span class="texatom" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">\mathbf{Z}</script> est constitué uniquement de la quatrième variable de la base, autrement dit X_3. La dernière ligne du tableau <code>data</code>
 indique les instanciations de X_3 et l'on peut observer que la valeur 0
 apparaît 2 fois et  la valeur 1 apparaît une fois. On a donc <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-410" style="width: 5.197em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.109em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.976em, 1000em, 3.187em, -0.513em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-411"><span class="msubsup" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 2.286em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-414"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-420" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.221em; vertical-align: -0.285em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">N_{Z=0} = 2</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-39-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-421" style="width: 5.197em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.109em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.976em, 1000em, 3.172em, -0.513em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 2.286em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-425"><span class="mrow" id="MathJax-Span-426"><span class="mi" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-428" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-431" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">N_{Z=1} = 1</script>. On peut observer que les valeurs de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-432" style="width: 1.77em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.39em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.567em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-433"><span class="msubsup" id="MathJax-Span-434"><span style="display: inline-block; position: relative; width: 1.38em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-436"><span class="mrow" id="MathJax-Span-437"><span class="texatom" id="MathJax-Span-438"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">N_{\mathbf{Z}}</script> sont bien les premiers éléments des couples de <code>resultat</code>. Lorsque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-41-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-441" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.947em, 1000em, 3.16em, -0.48em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-442"><span class="texatom" id="MathJax-Span-443"><span class="mrow" id="MathJax-Span-444"><span class="mi" id="MathJax-Span-445" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8709;</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.223em; vertical-align: -0.174em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">\mathbf{Z} = \emptyset</script>, <code>resultat</code> est un tableau avec un seul couple dont le premier élément correspond précisément à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-42-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-448" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">N</script>, le nombre d'enregistrements de la base de données.
</div><div class="vspace"></div><ul><li><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-43-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-451" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.378em, 1000em, 2.704em, -0.523em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-452"><span class="msubsup" id="MathJax-Span-453"><span style="display: inline-block; position: relative; width: 2.554em; height: 0px;"><span style="position: absolute; clip: rect(1.801em, 1000em, 2.84em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.605em;"><span class="texatom" id="MathJax-Span-455"><span class="mrow" id="MathJax-Span-456"><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-458" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="mo" id="MathJax-Span-460" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="mi" id="MathJax-Span-463" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.367em; vertical-align: -0.438em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">T_{X,Y,\mathbf{z}}</script> est un tableau 2D contenant le nombre d'occurrences <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-44-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-464" style="width: 2.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-465"><span class="msubsup" id="MathJax-Span-466"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="mi" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">N_{xy\mathbf{z}}</script> des couples <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-475" style="width: 8.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.587em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">(X=x,Y=y)</script> lorsque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-486" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.033em, 1000em, 3.082em, -0.48em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="texatom" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-492" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\mathbf{Z}=\mathbf{z}</script>. La première dimension de ce tableau (les lignes) correspondent aux différentes valeurs de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-47-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-495" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-496"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">X</script> et la deuxième (les colonnes) à celles de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-48-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-498" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">Y</script>. Ainsi, le tableau en haut à droite de <code>resultat</code> est obtenu de la manière suivante: ce tableau correspond à des occurrences de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-49-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-501" style="width: 3.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.84em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">(X,Y)</script> lorsque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-50-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-508" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.033em, 1000em, 3.104em, -0.48em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-509"><span class="texatom" id="MathJax-Span-510"><span class="mrow" id="MathJax-Span-511"><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-514" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.044em; vertical-align: -0.104em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">\mathbf{Z}=0</script>. on commence donc par extraire de <code>data</code>
 le sous-tableau correspondant à la première et à la troisième colonne 
(les colonnes où X_3=0) et on ne retient que les lignes correspondant à 
X_0 et X_2 (cf. les paramètres 0 et 2 passés en arguments de <strong>create_contingency_table</strong>). On obtient donc le sous-tableau:
</li></ul><div class="vspace"></div><pre> np.array ( [ [0, 1],    # instanciations de la variable X_0
              [0, 2]] )  # instanciations de la variable X_2
</pre><div class="vspace"></div><div class="indent">Ce tableau nous 
indique que, lorsque X_3=0, les couples (X_0=0,X_2=0) et (X_0=1,X_2=2) 
apparaissent une seule fois et ce sont les seuls couples qui 
apparaissent dans la base de données. C'est précisément ce que 
représente le tableau en haut à droite de <code>resultat</code>.
</div><p class="vspace">En utilisant la structure retournée par la fonction <strong>create_contingency_table</strong>, écrivez une fonction <strong>sufficient_statistics</strong><code>: int np.2D-array x dico{string -&gt; int} np.array x int x int x int list -&gt; float</code> qui prend les mêmes arguments que la fonction <strong>create_contingency_table</strong> et qui renvoie la valeur de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-515" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-516"><span class="msubsup" id="MathJax-Span-517"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="mo" id="MathJax-Span-527" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-528"><span class="mrow" id="MathJax-Span-529"><span class="mi" id="MathJax-Span-530" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">\chi^2_{X,Y|\mathbf{Z}}</script>. Vous pourrez tirer profit du fait que <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-52-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-531" style="width: 8.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.708em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.452em, -0.513em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="msubsup" id="MathJax-Span-533"><span style="display: inline-block; position: relative; width: 1.682em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-542" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.488em); top: -2.84em; left: 0em;"><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Size1; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.192em; left: 1.088em;"><span class="texatom" id="MathJax-Span-544"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-547" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-549"><span class="mrow" id="MathJax-Span-550"><span class="mi" id="MathJax-Span-551" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-553"><span class="mrow" id="MathJax-Span-554"><span class="mi" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.639em; vertical-align: -0.618em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">N_{x\mathbf{z}} = \sum_{y} N_{xy\mathbf{z}}</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-53-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-556" style="width: 8.471em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.708em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.316em, -0.513em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-557"><span class="msubsup" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 1.622em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-563"><span class="mrow" id="MathJax-Span-564"><span class="mi" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-567" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.488em); top: -2.84em; left: 0em;"><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Size1; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span><span style="position: absolute; top: -2.192em; left: 1.088em;"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-572" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-578"><span class="mrow" id="MathJax-Span-579"><span class="mi" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.469em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">N_{y\mathbf{z}} = \sum_{x} N_{xy\mathbf{z}}</script>, ce qui revient à faire des sommes sur chaque ligne ou chaque colonne des tableaux <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-54-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-581" style="width: 3.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.538em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.378em, 1000em, 2.704em, -0.523em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-582"><span class="msubsup" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 2.554em; height: 0px;"><span style="position: absolute; clip: rect(1.801em, 1000em, 2.84em, -0.523em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.12em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.605em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="mo" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.367em; vertical-align: -0.438em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">T_{X,Y,\mathbf{z}}</script>. <strong>Attention :</strong> il peut arriver que certains <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-55-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-594" style="width: 1.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.269em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.567em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-595"><span class="msubsup" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-598"><span class="mrow" id="MathJax-Span-599"><span class="texatom" id="MathJax-Span-600"><span class="mrow" id="MathJax-Span-601"><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">N_{\mathbf{z}}</script> soient égaux à 0. Dans ce cas, vous ne tiendrez pas compte des <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-56-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-603" style="width: 2.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.994em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 1.984em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-607"><span class="mrow" id="MathJax-Span-608"><span class="mi" id="MathJax-Span-609" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-611"><span class="mrow" id="MathJax-Span-612"><span class="mi" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">N_{xy\mathbf{z}}</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-57-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-614" style="width: 2.151em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.692em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.575em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 1.682em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-618"><span class="mrow" id="MathJax-Span-619"><span class="mi" id="MathJax-Span-620" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="texatom" id="MathJax-Span-621"><span class="mrow" id="MathJax-Span-622"><span class="mi" id="MathJax-Span-623" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.212em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">N_{x\mathbf{z}}</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-624" style="width: 2.075em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.632em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.712em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-625"><span class="msubsup" id="MathJax-Span-626"><span style="display: inline-block; position: relative; width: 1.622em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-628"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.004em;"></span></span><span class="texatom" id="MathJax-Span-631"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.385em; vertical-align: -0.448em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">N_{y\mathbf{z}}</script> correspondants dans la formule de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-59-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-634" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-635"><span class="msubsup" id="MathJax-Span-636"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-638" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-639"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-643" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mo" id="MathJax-Span-646" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-647"><span class="mrow" id="MathJax-Span-648"><span class="mi" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">\chi^2_{X,Y|\mathbf{Z}}</script> (car vous feriez des divisions par 0, ce qui est mal).
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock2">
  <div class="sourceblocktext"><div class="python"><span class="co1"># etant donné une BD data et son dictionnaire, cette fonction crée le</span><br>
<span class="co1"># tableau de contingence de (x,y) | z</span><br>
<span class="kw1">def</span> create_contingency_table <span class="br0">(</span> data<span class="sy0">,</span> dico<span class="sy0">,</span> x<span class="sy0">,</span> y<span class="sy0">,</span> z <span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="co1"># détermination de la taille de z</span><br>
&nbsp; &nbsp; size_z <span class="sy0">=</span> <span class="nu0">1</span><br>
&nbsp; &nbsp; offset_z <span class="sy0">=</span> np.<span class="me1">zeros</span> <span class="br0">(</span> <span class="kw2">len</span> <span class="br0">(</span> z <span class="br0">)</span> <span class="br0">)</span><br>
&nbsp; &nbsp; j <span class="sy0">=</span> <span class="nu0">0</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> i <span class="kw1">in</span> z:<br>
&nbsp; &nbsp; &nbsp; &nbsp; offset_z<span class="br0">[</span>j<span class="br0">]</span> <span class="sy0">=</span> size_z &nbsp; &nbsp; &nbsp; <br>
&nbsp; &nbsp; &nbsp; &nbsp; size_z *<span class="sy0">=</span> <span class="kw2">len</span> <span class="br0">(</span> dico<span class="br0">[</span>i<span class="br0">]</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; j +<span class="sy0">=</span> <span class="nu0">1</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># création du tableau de contingence</span><br>
&nbsp; &nbsp; res <span class="sy0">=</span> np.<span class="me1">zeros</span> <span class="br0">(</span> size_z<span class="sy0">,</span> dtype <span class="sy0">=</span> <span class="kw2">object</span> <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># remplissage du tableau de contingence</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> size_z <span class="sy0">!=</span> <span class="nu0">1</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; z_values <span class="sy0">=</span> np.<span class="me1">apply_along_axis</span> <span class="br0">(</span> <span class="kw1">lambda</span> val_z : val_z.<span class="me1">dot</span> <span class="br0">(</span> offset_z <span class="br0">)</span><span class="sy0">,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;<span class="nu0">1</span><span class="sy0">,</span> data<span class="br0">[</span>z<span class="sy0">,</span>:<span class="br0">]</span>.<span class="me1">T</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; i <span class="sy0">=</span> <span class="nu0">0</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">while</span> i <span class="sy0">&lt;</span> size_z:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indices<span class="sy0">,</span> <span class="sy0">=</span> np.<span class="me1">where</span> <span class="br0">(</span> z_values <span class="sy0">==</span> i <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a<span class="sy0">,</span>b<span class="sy0">,</span>c <span class="sy0">=</span> np.<span class="me1">histogram2d</span> <span class="br0">(</span> data<span class="br0">[</span>x<span class="sy0">,</span>indices<span class="br0">]</span><span class="sy0">,</span> data<span class="br0">[</span>y<span class="sy0">,</span>indices<span class="br0">]</span><span class="sy0">,</span> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bins <span class="sy0">=</span> <span class="br0">[</span> <span class="kw2">len</span> <span class="br0">(</span> dico<span class="br0">[</span>x<span class="br0">]</span> <span class="br0">)</span><span class="sy0">,</span> <span class="kw2">len</span> <span class="br0">(</span>dico<span class="br0">[</span>y<span class="br0">]</span> <span class="br0">)</span> <span class="br0">]</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; res<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> <span class="br0">(</span> indices.<span class="me1">size</span><span class="sy0">,</span> a <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i +<span class="sy0">=</span> <span class="nu0">1</span><br>
&nbsp; &nbsp; <span class="kw1">else</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; a<span class="sy0">,</span>b<span class="sy0">,</span>c <span class="sy0">=</span> np.<span class="me1">histogram2d</span> <span class="br0">(</span> data<span class="br0">[</span>x<span class="sy0">,</span>:<span class="br0">]</span><span class="sy0">,</span> data<span class="br0">[</span>y<span class="sy0">,</span>:<span class="br0">]</span><span class="sy0">,</span> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;bins <span class="sy0">=</span> <span class="br0">[</span> <span class="kw2">len</span> <span class="br0">(</span> dico<span class="br0">[</span>x<span class="br0">]</span> <span class="br0">)</span><span class="sy0">,</span> <span class="kw2">len</span> <span class="br0">(</span>dico<span class="br0">[</span>y<span class="br0">]</span> <span class="br0">)</span> <span class="br0">]</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; res<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">=</span> <span class="br0">(</span> data.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> a <span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> res</div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=2" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Vous pourrez vérifier la validité de vos calculs: en 
utilisant la base de données "2015_tme5_asia.csv", vous devriez obtenir 
les résultats suivants:
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">appel de la fonction</th><th align="center">résultat</th></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 1,2,[3])</td><td align="left">3.9466591186668296</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 0,1,[2,3])</td><td align="left">16.355207462350094</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 1,3,[2])</td><td align="left">81.807449348140295</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 5,2,[1,3,6])</td><td align="left">1897.0</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 0,7,[4,5])</td><td align="left">3.2223237760949699</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 2,3,[5])</td><td align="left">130.0</td></tr>
</tbody></table>
<p class="vspace"><br>
<span style="font-size:120%"><strong><span style="color: blue;">3. Statistique du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-60-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-650" style="width: 1.411em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.099em; height: 0px; font-size: 127%;"><span style="position: absolute; clip: rect(1.214em, 1000em, 2.551em, -0.424em); top: -2.197em; left: 0em;"><span class="mrow" id="MathJax-Span-651"><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 1.074em; height: 0px;"><span style="position: absolute; clip: rect(2.005em, 1000em, 2.951em, -0.424em); top: -2.597em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.597em;"></span></span><span style="position: absolute; top: -2.76em; left: 0.649em;"><span class="mn" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.397em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.197em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.445em; vertical-align: -0.323em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">\chi^2</script> et degré de liberté</span></strong></span>
</p>
<p class="vspace">Modifiez votre fonction <strong>sufficient_statistics</strong> afin qu'elle ne renvoie plus seulement <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-61-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-655" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-656"><span class="msubsup" id="MathJax-Span-657"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-665"><span class="mrow" id="MathJax-Span-666"><span class="mo" id="MathJax-Span-667" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\chi^2_{X,Y|\mathbf{Z}}</script> mais plutôt un couple (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-671" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-672"><span class="msubsup" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-679" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-684"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">\chi^2_{X,Y|\mathbf{Z}}</script>,DoF), où DoF est le nombre de degrés de liberté de votre statistique. Celui-ci est égal à :
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-63-Frame" style=""><nobr><span class="math" id="MathJax-Span-687" style="width: 20.425em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.195em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.332em, -0.45em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-688"><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-690"><span class="mrow" id="MathJax-Span-691"><span class="mo" id="MathJax-Span-692" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-693" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="texatom" id="MathJax-Span-694"><span class="mrow" id="MathJax-Span-695"><span class="mo" id="MathJax-Span-696" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-698" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mo" id="MathJax-Span-701" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mo" id="MathJax-Span-704" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="texatom" id="MathJax-Span-706"><span class="mrow" id="MathJax-Span-707"><span class="mo" id="MathJax-Span-708" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-709" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-710" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-713" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-714"><span class="mo" id="MathJax-Span-715" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main;">{</span><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="msubsup" id="MathJax-Span-721" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-723"><span class="mrow" id="MathJax-Span-724"><span class="texatom" id="MathJax-Span-725"><span class="mrow" id="MathJax-Span-726"><span class="mi" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8800;</span><span class="mn" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main;">}</span><span class="texatom" id="MathJax-Span-731"><span class="mrow" id="MathJax-Span-732"><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">(|X|-1) \times (|Y|-1) \times |\{\mathbf{z} : N_{\mathbf{z}} \neq 0\}| </script>
</p>
<p class="vspace">où <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-64-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-734" style="width: 1.77em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.39em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.271em, -0.425em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-735"><span class="texatom" id="MathJax-Span-736"><span class="mrow" id="MathJax-Span-737"><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="texatom" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.411em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">|X|</script> représente le nombre de valeurs possibles que peut prendre la variable <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-65-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-743" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">X</script>, autrement dit, c'est la taille de son dictionnaire. Le dernier terme de l'équation est simplement le nombre de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-66-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-746" style="width: 1.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.269em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.567em, -0.513em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-747"><span class="msubsup" id="MathJax-Span-748"><span style="display: inline-block; position: relative; width: 1.259em; height: 0px;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.513em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.821em;"><span class="texatom" id="MathJax-Span-750"><span class="mrow" id="MathJax-Span-751"><span class="texatom" id="MathJax-Span-752"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.202em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">N_{\mathbf{z}}</script> différents de 0.
</p>
<p class="vspace">Vous pourrez vérifier la validité de vos calculs: en 
utilisant la base de données "2015_tme5_asia.csv", vous devriez obtenir 
les résultats suivants:
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">appel de la fonction</th><th align="center">résultat</th></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 1,2,[3])</td><td align="left">(3.9466591186668296, 2)</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 0,1,[2,3])</td><td align="left">(16.355207462350094, 3)</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 1,3,[2])</td><td align="left">(81.807449348140295, 2)</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 5,2,[1,3,6])</td><td align="left">(1897.0, 8)</td></tr>
<tr><td align="left">sufficient_statistics ( data, dico, 0,7,[4,5])</td><td align="left">(3.2223237760949699, 4)</td></tr>
<tr><td>sufficient_statistics ( data, dico, 2,3,[5])</td><td align="left">(130.0, 2)</td></tr>
</tbody></table>
<p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">4. Test d'indépendance</span></strong></span>
</p>
<p class="vspace">En cours, nous avons vu que, pour un risque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-67-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-755" style="width: 0.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math; font-style: italic;">&#945;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">\alpha</script> donné, si la statistique <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-68-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-758" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="msubsup" id="MathJax-Span-760"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-762" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-766" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="mo" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">\chi^2_{X,Y|\mathbf{Z}}</script> est inférieure au seuil critique <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-69-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-774" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.613em, 1000em, 2.575em, -0.51em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-775"><span class="msubsup" id="MathJax-Span-776"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="texatom" id="MathJax-Span-778"><span class="mrow" id="MathJax-Span-779"><span class="mi" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">&#945;</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.908em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">c_{\alpha}</script> de la loi du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-70-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-781" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-782"><span class="msubsup" id="MathJax-Span-783"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-785" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">\chi^2</script> à DoF degrés de liberté, alors <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-71-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-786" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">X</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-789" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-790"><span class="mi" id="MathJax-Span-791" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">Y</script> sont considérés comme indépendants conditionnellement à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-73-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-792" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-793"><span class="texatom" id="MathJax-Span-794"><span class="mrow" id="MathJax-Span-795"><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\mathbf{Z}</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-74-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-797" style="width: 5.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.351em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.331em, -0.518em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-798"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8869;</span><span class="mspace" id="MathJax-Span-801" style="height: 0em; vertical-align: 0em; margin-left: -0.388em;"></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main;">&#8869;</span><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="texatom" id="MathJax-Span-804"><span class="mrow" id="MathJax-Span-805"><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-807"><span class="mrow" id="MathJax-Span-808"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.411em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">X \perp\hspace{-1.7mm}\perp Y | \mathbf{Z}</script>). On peut reformuler cette propriété de la manière suivante : 
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-75-Frame" style=""><nobr><span class="math" id="MathJax-Span-810" style="width: 19.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.349em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.904em, 1000em, 3.624em, -0.544em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-811"><span class="mtext" id="MathJax-Span-812" style="font-family: MathJax_Main;">p-value</span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-814"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-815" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-821" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-822"><span class="mrow" id="MathJax-Span-823"><span class="mo" id="MathJax-Span-824" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="mi" id="MathJax-Span-827" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8805;</span><span class="mi" id="MathJax-Span-830" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">&#945;</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.278em;">&#10234;</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main; padding-left: 0.278em;">&#8869;</span><span class="mspace" id="MathJax-Span-834" style="height: 0em; vertical-align: 0em; margin-left: -0.388em;"></span><span class="mo" id="MathJax-Span-835" style="font-family: MathJax_Main;">&#8869;</span><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="texatom" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mo" id="MathJax-Span-839" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-840"><span class="mrow" id="MathJax-Span-841"><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-75">\text{p-value}(\chi^2_{X,Y|\mathbf{Z}}) \geq \alpha \Longleftrightarrow X \perp\hspace{-1.7mm}\perp Y | \mathbf{Z}</script>
</p>
<p class="vspace">La p-value d'un nombre x est l'intégrale de la fonction de densité de la loi du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-76-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-843" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-844"><span class="msubsup" id="MathJax-Span-845"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-847" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">\chi^2</script> de x à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-77-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-848" style="width: 2.227em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.752em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.076em, 1000em, 3.104em, -0.488em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-849"><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Main;">&#8734;</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.99em; vertical-align: -0.179em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">+\infty</script> (autrement dit, c'est la surface de la partie grisée sur votre table du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-852" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-853"><span class="msubsup" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-856" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">\chi^2</script> à partir de l'abscisse x. On a donc p-value<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-79-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-857" style="width: 4.664em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.686em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.909em, 1000em, 3.272em, -0.45em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-858"><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-860"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="texatom" id="MathJax-Span-862"><span class="mrow" id="MathJax-Span-863"><span class="mi" id="MathJax-Span-864" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">&#945;</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-865" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">&#945;</span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.412em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">(c_{\alpha}) = \alpha</script>).
 En statistiques, on considère qu'elle n'a du sens que si les valeurs du
 tableau de contingence sont toutes supérieures ou égales à 5 (autrement
 dit, un test d'indépendance du <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-80-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-868" style="width: 1.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.221em, 1000em, 2.621em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-869"><span class="msubsup" id="MathJax-Span-870"><span style="display: inline-block; position: relative; width: 1.042em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.841em; left: 0.604em;"><span class="mn" id="MathJax-Span-872" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.46em; vertical-align: -0.333em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">\chi^2</script>
 n'est "valide" que si toutes les valeurs du tableau de contingence sont
 supérieures ou égales à 5). En informatique, on allège souvent cette 
règle en considérant que le test est valide dès lors que la valeur 
moyenne des cases est supérieure ou égale à 5. Cet allègement permet de 
tester la validité du test sans réaliser celui-ci : si le nombre de 
lignes du CSV est supérieure ou égale à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-81-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-873" style="width: 14.334em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.361em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.969em, 1000em, 3.331em, -0.511em); top: -2.901em; left: 0em;"><span class="mrow" id="MathJax-Span-874"><span class="msubsup" id="MathJax-Span-875"><span style="display: inline-block; position: relative; width: 1.885em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.85em, -0.511em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.541em;"><span class="texatom" id="MathJax-Span-877"><span class="mrow" id="MathJax-Span-878"><span class="mi" id="MathJax-Span-879" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-881" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span><span class="mo" id="MathJax-Span-882" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-883" style="font-family: MathJax_Main; padding-left: 0.278em;">5</span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-885" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-886"><span class="mo" id="MathJax-Span-887" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="texatom" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-893" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-894"><span class="mo" id="MathJax-Span-895" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-900" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="texatom" id="MathJax-Span-901" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-902"><span class="mo" id="MathJax-Span-903" style="font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-904"><span class="mrow" id="MathJax-Span-905"><span class="mi" id="MathJax-Span-906" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span><span class="texatom" id="MathJax-Span-907"><span class="mrow" id="MathJax-Span-908"><span class="mo" id="MathJax-Span-909" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.901em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.411em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">d_{min} = 5 \times |X| \times |Y| \times |\mathbf{Z}|</script>, le test est considéré comme valide.
</p>
<p class="vspace">Ecrivez une fonction <strong>indep_score</strong> <code>: int np.2D-array x dico{string -&gt; int} np.array x int x int x int list -&gt; (float,int)</code>
 qui, étant donné les mêmes paramètres que ceux de la question 
précédente, vous renvoie un couple contenant la p-value correspondant à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-910" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-911"><span class="msubsup" id="MathJax-Span-912"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-913" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-914" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-915"><span class="mrow" id="MathJax-Span-916"><span class="mi" id="MathJax-Span-917" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-918" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-919" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mo" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-923"><span class="mrow" id="MathJax-Span-924"><span class="mi" id="MathJax-Span-925" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">\chi^2_{X,Y|\mathbf{Z}}</script>
 ainsi que le nombre de degrés de liberté de cette statistique. Vous 
testerez au préalable si len ( data[0] ), le nombre de 
lignes/enregistrements de votre CSV, est supérieur ou non à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-83-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-926" style="width: 2.379em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.873em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.361em, 1000em, 2.575em, -0.511em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-927"><span class="msubsup" id="MathJax-Span-928"><span style="display: inline-block; position: relative; width: 1.885em; height: 0px;"><span style="position: absolute; clip: rect(1.784em, 1000em, 2.85em, -0.511em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.541em;"><span class="texatom" id="MathJax-Span-930"><span class="mrow" id="MathJax-Span-931"><span class="mi" id="MathJax-Span-932" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-933" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-934" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.226em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">d_{min}</script>
 ; si c'est inférieur, vous renverrez le couple (-1,1), qui représente 
une indépendance. Vous pourrez vous aider de la fonction 
scipy.stats.chi2.sf ( x, DoF ) qui renvoie la p-value (x) pour une loi à
 DoF degrés de liberté.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock3">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> scipy.<span class="me1">stats</span> <span class="kw1">as</span> stats<br>
stats.<span class="me1">chi2</span>.<span class="me1">sf</span> <span class="br0">(</span> x<span class="sy0">,</span> DoF <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=3" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Vous pourrez vérifier la validité de vos calculs: en 
utilisant la base de données "2015_tme5_asia.csv", vous devriez obtenir 
les résultats suivants:
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">appel de la fonction</th><th align="center">résultat</th></tr>
<tr><td align="left">indep_score ( data, dico, 1,3,[])</td><td align="left">2.38520176938e-19</td></tr>
<tr><td align="left">indep = indep_score ( data, dico, 1, 7, [])</td><td align="left">1.12562784979e-10</td></tr>
<tr><td align="left">indep = indep_score ( data, dico, 0, 1,[2, 3])</td><td align="left">0.000958828236575</td></tr>
<tr><td align="left">indep = indep_score ( data, dico, 1, 2,[3, 4])</td><td align="left">0.475266197894</td></tr>
</tbody></table>
<p class="vspace"><br>
</p><hr>
<h2 style="background-color: #e6d8c0;">Partie optionnelle</h2>
<hr>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">5. Meilleur candidat pour être un parent</span></strong></span>
</p>
<p class="vspace">Ecrivez une fonction <strong>best_candidate</strong> <code>: int np.2D-array x dico{string -&gt; int} np.array x int x int list x float -&gt; int list</code> qui, étant donné les tableaux <code>data</code> et <code>dico</code> calculés à la question 1, l'index d'une variable aléatoire <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-84-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-935" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-936"><span class="mi" id="MathJax-Span-937" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">X</script>, la liste d'index d'un ensemble de variables aléatoires <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-85-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-938" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-939"><span class="texatom" id="MathJax-Span-940"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">\mathbf{Z}</script> et un risque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-86-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-943" style="width: 0.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-944"><span class="mi" id="MathJax-Span-945" style="font-family: MathJax_Math; font-style: italic;">&#945;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">\alpha</script>, détermine la variable <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-87-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-946" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-947"><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">Y</script> (en fait, l'index de sa colonne dans le CSV), parmi toutes celles à gauche de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-88-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-949" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-950"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">X</script> dans le fichier CSV, qui est la plus dépendante de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-89-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-952" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-953"><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">X</script> conditionnellement à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-90-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-955" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-956"><span class="texatom" id="MathJax-Span-957"><span class="mrow" id="MathJax-Span-958"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">\mathbf{Z}</script>, autrement dit, celle qui a la plus petite p-value. Si cette p-value est supérieure à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-91-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-960" style="width: 0.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-961"><span class="mi" id="MathJax-Span-962" style="font-family: MathJax_Math; font-style: italic;">&#945;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">\alpha</script>, cela veut dire que <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-92-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-963" style="width: 3.369em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.239em, 1000em, 2.959em, -0.519em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-964"><span class="msubsup" id="MathJax-Span-965"><span style="display: inline-block; position: relative; width: 2.674em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 3.044em, -0.519em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-966" style="font-family: MathJax_Math; font-style: italic;">&#967;</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; clip: rect(1.825em, 1000em, 2.659em, -0.509em); top: -2.822em; left: 0.604em;"><span class="mn" id="MathJax-Span-967" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span><span style="position: absolute; clip: rect(1.766em, 1000em, 2.835em, -0.525em); top: -2.112em; left: 0.604em;"><span class="texatom" id="MathJax-Span-968"><span class="mrow" id="MathJax-Span-969"><span class="mi" id="MathJax-Span-970" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-971" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-972" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span class="texatom" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mo" id="MathJax-Span-975" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="texatom" id="MathJax-Span-976"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.863em; vertical-align: -0.759em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\chi^2_{X,Y|\mathbf{Z}}</script> est inférieur à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-93-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-979" style="width: 1.161em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.906em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.613em, 1000em, 2.575em, -0.51em); top: -2.236em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="msubsup" id="MathJax-Span-981"><span style="display: inline-block; position: relative; width: 0.921em; height: 0px;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span><span style="position: absolute; top: -2.328em; left: 0.423em;"><span class="texatom" id="MathJax-Span-983"><span class="mrow" id="MathJax-Span-984"><span class="mi" id="MathJax-Span-985" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">&#945;</span></span></span><span style="display: inline-block; width: 0px; height: 2.478em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.236em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.908em; vertical-align: -0.275em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">c_{\alpha}</script> et donc que <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-94-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-986" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">Y</script> est jugée indépendante de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-95-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-989" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-990"><span class="mi" id="MathJax-Span-991" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">X</script> conditionnellement à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-992" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-993"><span class="texatom" id="MathJax-Span-994"><span class="mrow" id="MathJax-Span-995"><span class="mi" id="MathJax-Span-996" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">\mathbf{Z}</script>. Votre fonction renverra une liste vide si <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-997" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-998"><span class="mi" id="MathJax-Span-999" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">Y</script> est indépendante de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1000" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.846em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.84em, -0.518em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-1001"><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.013em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">X</script> conditionnellement à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-99-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1003" style="width: 0.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.725em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.973em, 1000em, 3.022em, -0.48em); top: -2.84em; left: 0em;"><span class="mrow" id="MathJax-Span-1004"><span class="texatom" id="MathJax-Span-1005"><span class="mrow" id="MathJax-Span-1006"><span class="mi" id="MathJax-Span-1007" style="font-family: MathJax_Main; font-weight: bold;">Z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.84em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.017em; vertical-align: -0.076em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">\mathbf{Z}</script>, sinon elle renverra une liste contenant <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-100-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1008" style="width: 1.009em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.786em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(1.795em, 1000em, 2.839em, -0.514em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-1009"><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.012em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">Y</script>. Vous pourrez tester votre fonction avec <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-101-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1011" style="width: 0.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 126%;"><span style="position: absolute; clip: rect(2.036em, 1000em, 2.851em, -0.51em); top: -2.659em; left: 0em;"><span class="mrow" id="MathJax-Span-1012"><span class="mi" id="MathJax-Span-1013" style="font-family: MathJax_Math; font-style: italic;">&#945;</span></span><span style="display: inline-block; width: 0px; height: 2.659em;"></span></span></span><span style="border-left: 0em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.723em; vertical-align: -0.09em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">\alpha</script> = 0.05:
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">appel de la fonction</th><th align="center">résultat</th></tr>
<tr><td align="left">best_candidate ( data, dico, 1, [], 0.05 )</td><td align="center">[]</td></tr>
<tr><td align="left">best_candidate ( data, dico, 4, [], 0.05 )</td><td align="center">[1]</td></tr>
<tr><td align="left">best_candidate ( data, dico, 4, [1], 0.05 )</td><td align="center">[]</td></tr>
<tr><td align="left">best_candidate ( data, dico, 5, [], 0.05 )</td><td align="center">[3]</td></tr>
<tr><td align="left">best_candidate ( data, dico, 5, [6], 0.05 )</td><td align="center">[3]</td></tr>
<tr><td align="left">best_candidate ( data, dico, 5, [6,7], 0.05 )</td><td align="center">[2]</td></tr>
</tbody></table>
<p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">6. Création des parents d'un noeud</span></strong></span>
</p>
<p class="vspace">Ecrivez une fonction <strong>create_parents</strong> (
 data, dico, x, alpha ) qui, étant donné une variable aléatoire x et un 
niveau de risque alpha, retourne la liste z de ses parents dans le 
réseau bayésien. L'algorithme est le suivant :  partez de z = l'ensemble
 vide, puis tant que <strong>best_candidate</strong> ( x, z, alpha ) 
vous renvoie une liste non vide [y], rajoutez y à z. Lorsque vous 
sortirez de cette boucle, toutes les autres variables seront 
indépendantes de x conditionnellement à z.
</p>
<p class="vspace">L'algorithme qui consiste à appliquer, pour chaque noeud/variable aléatoire, votre fonction <strong>create_parents</strong> correspond, en grande partie, à l'article suivant :
</p>
<p class="vspace">Gregory F. Cooper and Edward Herskovits (1992) "A Bayesian method for the induction of probabilistic networks from data", <em>Machine Learning</em>, Vol. 9, n°4, pp. 309-347.<br><br>
Vous pourrez tester la validité de votre fonction :
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">appel de la fonction</th><th align="center">résultat</th></tr>
<tr><td align="left">create_parents ( data, dico, 1, 0.05 )</td><td align="left">[]</td></tr>
<tr><td align="left">create_parents ( data, dico, 4, 0.05 )</td><td align="left">[1]</td></tr>
<tr><td align="left">create_parents ( data, dico, 5, 0.05 )</td><td align="left">[3, 2]</td></tr>
<tr><td align="left">create_parents ( data, dico, 6, 0.05 )</td><td align="left">[4, 5]</td></tr>
</tbody></table>
<p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">7. Apprentissage de la structure d'un réseau bayésien</span></strong></span>
</p>
<p class="vspace">Ecrivez une fonction <strong>learn_BN_structure</strong>
 ( data, dico, alpha ) qui renvoie un tableau contenant, pour chaque 
noeud, la liste de ses parents. Ainsi, si votre fonction vous renvoie le
 tableau ci-dessous,
</p>
<div class="vspace"></div><pre> array( [ [], [], [], [1, 0], [1], [3, 2], [4, 5], [5] ] )
</pre><p class="vspace">les noeud correspondant aux 2 premières colonnes
 du CSV n'ont pas de parents, le noeud de la 3ème colonne a pour parent 
celui de la 1ère colonne, etc.
</p>
<p class="vspace">Pour visualiser plus aisément votre structure, utilisez la fonction <strong>display_BN</strong> ci-dessous. Celle-ci prend en paramètres :
</p>
<div class="vspace"></div><ol><li>le tableau des noms des variables aléatoires déterminé à la question 1
</li><li>la structure que vous avez calculée avec votre fonction <strong>learn_BN_structure</strong>
</li><li>un nom que vous voulez donner à votre réseau
</li><li>un style pour afficher les noeuds
</li></ol><div class="vspace"></div>
<div class="sourceblock " id="sourceblock4">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> pydotplus<br>
<span class="kw1">import</span> matplotlib.<span class="me1">pyplot</span> <span class="kw1">as</span> plt<br>
<span class="kw1">import</span> matplotlib.<span class="me1">image</span> <span class="kw1">as</span> mpimg<br>
<br>
style <span class="sy0">=</span> <span class="br0">{</span> <span class="st0">"bgcolor"</span> : <span class="st0">"#6b85d1"</span><span class="sy0">,</span> <span class="st0">"fgcolor"</span> : <span class="st0">"#FFFFFF"</span> <span class="br0">}</span><br>
<br>
<span class="kw1">def</span> display_BN <span class="br0">(</span> node_names<span class="sy0">,</span> bn_struct<span class="sy0">,</span> bn_name<span class="sy0">,</span> style <span class="br0">)</span>:<br>
&nbsp; &nbsp; graph <span class="sy0">=</span> pydot.<span class="me1">Dot</span><span class="br0">(</span> bn_name<span class="sy0">,</span> graph_type<span class="sy0">=</span><span class="st0">'digraph'</span><span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># création des noeuds du réseau</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> name <span class="kw1">in</span> node_names:<br>
&nbsp; &nbsp; &nbsp; &nbsp; new_node <span class="sy0">=</span> pydot.<span class="me1">Node</span><span class="br0">(</span> name<span class="sy0">,</span> <br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;style<span class="sy0">=</span><span class="st0">"filled"</span><span class="sy0">,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fillcolor<span class="sy0">=</span>style<span class="br0">[</span><span class="st0">"bgcolor"</span><span class="br0">]</span><span class="sy0">,</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fontcolor<span class="sy0">=</span>style<span class="br0">[</span><span class="st0">"fgcolor"</span><span class="br0">]</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; graph.<span class="me1">add_node</span><span class="br0">(</span> new_node <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># création des arcs</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> node <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> <span class="kw2">len</span> <span class="br0">(</span> node_names <span class="br0">)</span> <span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; parents <span class="sy0">=</span> bn_struct<span class="br0">[</span>node<span class="br0">]</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> par <span class="kw1">in</span> parents:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new_edge <span class="sy0">=</span> pydot.<span class="me1">Edge</span> <span class="br0">(</span> node_names<span class="br0">[</span>par<span class="br0">]</span><span class="sy0">,</span> node_names<span class="br0">[</span>node<span class="br0">]</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; graph.<span class="me1">add_edge</span> <span class="br0">(</span> new_edge <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># sauvegarde et affaichage</span><br>
&nbsp; &nbsp; outfile <span class="sy0">=</span> bn_name + <span class="st0">'.png'</span><br>
&nbsp; &nbsp; graph.<span class="me1">write_png</span><span class="br0">(</span> outfile <span class="br0">)</span><br>
&nbsp; &nbsp; img <span class="sy0">=</span> mpimg.<span class="me1">imread</span> <span class="br0">(</span> outfile <span class="br0">)</span><br>
&nbsp; &nbsp; plt.<span class="me1">imshow</span><span class="br0">(</span> img <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=4" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><div style="text-align: center;">   <img src="MAPSI%20Cours_TME%205_fichiers/2014_tme5_asia.png" alt="" title="" width="400px"><br><br></div>
<p><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">7. Fin de l'apprentissage et calcul probabiliste</span></strong></span>
</p>
<p class="vspace">Comme précisé au début du TME, apprendre un réseau 
bayésien consiste à déterminer sa structure graphique et estimer ses 
paramètres. Vous avez réalisé la première partie. La deuxième, plus 
simple, peut se faire par maximum de vraisemblance pour chaque table de 
probabilité des noeuds conditionnellement à leurs parents, comme dans le
 TME 3. Utilisez la fonction <strong>learn_parameters</strong> 
ci-dessous pour effectuer cette tâche. Cette fonction prend en 
paramètres la structure graphique que vous avez apprise ainsi que le nom
 du fichier CSV que vous avez utilisé pour votre apprentissage. Elle 
renvoie un réseau bayésien à la  <a target="_blank" class="urllink" href="http://agrum.lip6.fr/" rel="nofollow">aGrUM</a>. Pour pouvoir utiliser aGrUM, reportez-vous à la  <a target="_blank" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME2#agrum">question 7 du TME 2</a>.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock5">
  <div class="sourceblocktext"><div class="python"><span class="kw1">import</span> pyAgrum <span class="kw1">as</span> gum<br>
<span class="kw1">import</span> pyAgrum.<span class="me1">lib</span>.<span class="me1">ipython</span> <span class="kw1">as</span> gnb<br>
<br>
<br>
<span class="kw1">def</span> learn_parameters <span class="br0">(</span> bn_struct<span class="sy0">,</span> ficname <span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="co1"># création du dag correspondant au bn_struct</span><br>
&nbsp; &nbsp; graphe <span class="sy0">=</span> gum.<span class="me1">DAG</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; nodes <span class="sy0">=</span> <span class="br0">[</span> graphe.<span class="me1">addNode</span> <span class="br0">(</span><span class="br0">)</span> <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> bn_struct.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="br0">)</span> <span class="br0">]</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> bn_struct.<span class="me1">shape</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">for</span> parent <span class="kw1">in</span> bn_struct<span class="br0">[</span>i<span class="br0">]</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; graphe.<span class="me1">addArc</span> <span class="br0">(</span> nodes<span class="br0">[</span>parent<span class="br0">]</span><span class="sy0">,</span> nodes<span class="br0">[</span>i<span class="br0">]</span> <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># appel au BNLearner pour apprendre les paramètres</span><br>
&nbsp; &nbsp; learner <span class="sy0">=</span> gum.<span class="me1">BNLearner</span> <span class="br0">(</span> ficname <span class="br0">)</span><br>
&nbsp; &nbsp; learner.<span class="me1">useScoreLog2Likelihood</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; learner.<span class="me1">useAprioriSmoothing</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">return</span> learner.<span class="me1">learnParameters</span> <span class="br0">(</span> graphe <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=5" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">Vous pouvez maintenant réaliser des calculs probabilistes :
</p>
<div class="vspace"></div><ul><li>affichage de la taille du réseau bayésien
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock6">
  <div class="sourceblocktext"><div class="python"><span class="co1"># création du réseau bayésien à la aGrUM</span><br>
bn <span class="sy0">=</span> learn_parameters <span class="br0">(</span> bn_struct<span class="sy0">,</span> ficname <span class="br0">)</span><br>
<br>
<span class="co1"># affichage de sa taille</span><br>
<span class="kw1">print</span><span class="br0">(</span>bn<span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=6" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>affichage de la table de probabilité conditionnelle d'un noeud du réseau déterminé par son nom (1ère ligne du CSV):
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock7">
  <div class="sourceblocktext"><div class="python"><span class="co1"># récupération de la ''conditional probability table'' (CPT) et affichage de cette table</span><br>
gnb.<span class="me1">showPotential</span><span class="br0">(</span> bn.<span class="me1">cpt</span> <span class="br0">(</span> bn.<span class="me1">idFromName</span> <span class="br0">(</span> <span class="st0">'bronchitis?'</span> <span class="br0">)</span> <span class="br0">)</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=7" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>calcul de la probabilité marginale d'un noeud : P('bronchitis?'):
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock8">
  <div class="sourceblocktext"><div class="python"><span class="co1"># calcul de la marginale</span><br>
proba <span class="sy0">=</span> gum.<span class="me1">getPosterior</span> <span class="br0">(</span> bn<span class="sy0">,</span> <span class="br0">{</span><span class="br0">}</span><span class="sy0">,</span> <span class="st0">'bronchitis?'</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=8" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>affichage graphique d'une distribution de probabilité marginale
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock9">
  <div class="sourceblocktext"><div class="python"><span class="co1"># affichage de la marginale</span><br>
gnb.<span class="me1">showPotential</span><span class="br0">(</span> proba <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=9" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><ul><li>calcul d'une distribution marginale a posteriori : P(bronchitis? | smoking? = true, turberculosis? = false )
</li></ul><div class="vspace"></div>
<div class="sourceblock " id="sourceblock10">
  <div class="sourceblocktext"><div class="python">gnb.<span class="me1">showPotential</span><span class="br0">(</span>gum.<span class="me1">getPosterior</span> <span class="br0">(</span> bn<span class="sy0">,</span><span class="br0">{</span><span class="st0">'smoking?'</span>: <span class="st0">'true'</span><span class="sy0">,</span> <span class="st0">'tuberculosis?'</span> : <span class="st0">'false'</span> <span class="br0">}</span><span class="sy0">,</span> <span class="st0">'bronchitis?'</span> <span class="br0">)</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=sourceblock&amp;num=10" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">8. (Bonus) Autres bases de données</span></strong></span>
</p>
<p class="vspace">Vous pouvez appliquer vos algorithmes sur des bases un peu plus conséquentes qu'asia:
</p>
<div class="vspace"></div>
<table border="1" align="center"><tbody><tr><th align="center">nom de la base</th><th align="center">dataset</th><th align="center">nb de lignes de la base</th><th align="center">événements élémentaires</th></tr>
<tr><td align="center">asia</td><td align="center"><a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2014_tme5_asia3.csv" rel="nofollow">asia  dataset</a></td><td align="center">30000</td><td align="center">256</td></tr>
<tr><td align="center">adult</td><td align="center"><a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2014_tme5_adult.csv" rel="nofollow">adult dataset</a></td><td align="center">30162</td><td align="center">10<sup>12</sup></td></tr>
<tr><td align="center">car</td><td align="center"><a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2014_tme5_car.csv" rel="nofollow">car   dataset</a></td><td align="center">1728</td><td align="center">6912</td></tr>
<tr><td align="center">agaricus-lepiota</td><td align="center"><a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2014_tme5_agaricus_lepiota.csv" rel="nofollow">agaricus-lepiota dataset</a></td><td align="center">8124</td><td align="center">10<sup>16</sup></td></tr>
<tr><td align="center">alarm</td><td align="center"><a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2014_tme5_alarm.csv" rel="nofollow">alarm dataset</a></td><td align="center">20000</td><td align="center">10<sup>16</sup></td></tr>
</tbody></table>
<div class="vspace"></div>
</div>

				</div>
			</div>

			<div id="sidebar">
				<!--PageSearchFmt-->
				<div class="boxy short">
					<div id="search">
						<h3>Search</h3>

						<form id="searchform" action="http://mapsi.lip6.fr/pmwiki.php" method="get">
						<fieldset>
							<input type="hidden" name="n" value="Cours.TME5">
							<input type="hidden" name="action" value="search">
							<input class="searchBox" type="text" id="q" name="q">
							<input class="searchButton" type="submit" value="Go">
						</fieldset>
						</form>
					</div>
				</div>
				<!--/PageSearchFmt-->

				<!--PageRightFmt-->
				<div class="boxy tall">
					<p class="sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.TutoPythonJN">Tutoriel numpy</a>
</p>
<div class="vspace"></div>

				</div>
				<!--/PageRightFmt-->
			</div>
		</div>

		<div id="options-container">
			<!--PageOptionsFmt-->
			<div id="options">
				<h2>Options:</h2>
				<ul id="option_size">
					<li title="size: fixed" id="option_size_fixed" class="fixed"><a><span>fixed</span></a></li>
					<li title="size: fluid" id="option_size_fluid" class="fluid"><a><span>fluid</span></a></li>
				</ul>

				<ul id="option_color">
					<li title="color: orange" id="option_color_orange" class="orange"><a><span>orange</span></a></li>
					<li title="color: blue" id="option_color_blue" class="blue"><a><span>blue</span></a></li>
					<li title="color: green" id="option_color_green" class="green"><a><span>green</span></a></li>
					<li title="color: pink" id="option_color_pink" class="pink"><a><span>pink</span></a></li>
					<li title="color: cyan" id="option_color_cyan" class="cyan"><a><span>cyan</span></a></li>
					<li title="color: red" id="option_color_red" class="red"><a><span>red</span></a></li>
					<li title="color: violet" id="option_color_violet" class="violet"><a><span>violet</span></a></li>
				</ul>
			</div>
			<!--/PageOptionsFmt-->

			<!--PageActionFmt-->
			<div class="pageactions">
				<ul><li class="browse">      <a accesskey="" rel="nofollow" class="selflink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5">View</a>
</li><li class="edit">      <a accesskey="e" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=edit">Edit</a>
</li><li class="diff">   <a accesskey="h" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=diff">History</a>
</li><li class="print">     <a accesskey="" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME5?action=print">Print</a>
</li></ul>

			</div>
			<!--/PageActionFmt-->
		</div>

		<div id="footer">
			<!--PageFooterFmt-->
				<div class="footer"><p>Page last modified on October 23, 2017, at 11:04 AM EST
</p>
</div>
			<!--/PageFooterFmt-->
			<p id="credits"><a href="http://evil.che.lu/projects/skittlish">Skittlish</a> theme adapted by <a href="http://solidgone.org/Skins/">David Gilbert</a>, powered by <a href="http://pmwiki.com/">PmWiki</a></p>
		</div>
	</div>
<!--HTMLFooter-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>